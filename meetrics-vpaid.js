/* 
* !Meetrics VPAID JS Proxy | release 2020-02-05 
*/ 
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.DMVAST=a()}}(function(){return function(){function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){return e(b[g][1][a]||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}return a}()({1:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if((b=arguments[1])instanceof Error)throw b;var k=new Error('Uncaught, unspecified "error" event. ('+b+")");throw k.context=b,k}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),c.apply(this,f)}else if(g(c))for(f=Array.prototype.slice.call(arguments,1),j=c.slice(),d=j.length,i=0;i<d;i++)j[i].apply(this,f);return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned&&(c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners)&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace()),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(d<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else if(c)for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){return this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.prototype.listenerCount=function(a){if(this._events){var b=this._events[a];if(e(b))return 1;if(b)return b.length}return 0},d.listenerCount=function(a,b){return a.listenerCount(b)}},{}],2:[function(a,b,c){var d;d=function(){function a(){this.id=null,this.sequence=null,this.system=null,this.title=null,this.description=null,this.advertiser=null,this.pricing=null,this.survey=null,this.errorURLTemplates=[],this.impressionURLTemplates=[],this.creatives=[],this.extensions=[]}return a}(),b.exports=d},{}],3:[function(a,b,c){var d,e,f;e=a("./parser"),f=a("./util"),d=function(){function a(){}return a.cappingFreeLunch=0,a.cappingMinimumTimeInterval=0,a.options={withCredentials:!1,timeout:0},a.get=function(a,b,d){var f,g,h,i;if(g=+new Date,f=c.extend=function(a,b){var c,d;for(c in b)d=b[c],a[c]=d;return a},d||("function"==typeof b&&(d=b),h={}),h=f(this.options,b),this.totalCallsTimeout<g?(this.totalCalls=1,this.totalCallsTimeout=g+36e5):this.totalCalls++,this.cappingFreeLunch>=this.totalCalls)return void d(null,new Error("VAST call canceled â€“ FreeLunch capping not reached yet "+this.totalCalls+"/"+this.cappingFreeLunch));if((i=g-this.lastSuccessfullAd)<0)this.lastSuccessfullAd=0;else if(i<this.cappingMinimumTimeInterval)return void d(null,new Error("VAST call canceled â€“ ("+this.cappingMinimumTimeInterval+")ms minimum interval reached"));return e.parse(a,h,function(a){return function(a,b){return d(a,b)}}())},function(){var b,c;c=f.storage,b=Object.defineProperty,["lastSuccessfullAd","totalCalls","totalCallsTimeout"].forEach(function(d){b(a,d,{get:function(){return c.getItem(d)},set:function(a){return c.setItem(d,a)},configurable:!1,enumerable:!0})}),null==a.lastSuccessfullAd&&(a.lastSuccessfullAd=0),null==a.totalCalls&&(a.totalCalls=0),null==a.totalCallsTimeout&&(a.totalCallsTimeout=0)}(),a}(),b.exports=d},{"./parser":12,"./util":18}],4:[function(a,b,c){var d;d=function(){function a(){this.id=null,this.width=0,this.height=0,this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.altText=null,this.companionClickThroughURLTemplate=null,this.companionClickTrackingURLTemplates=[],this.trackingEvents={}}return a}(),b.exports=d},{}],5:[function(a,b,c){var d,e,f,g,h=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},i={}.hasOwnProperty;d=function(){function a(a){null==a&&(a={}),this.id=a.id||null,this.adId=a.adId||null,this.sequence=a.sequence||null,this.apiFramework=a.apiFramework||null,this.trackingEvents={}}return a}(),f=function(a){function b(){b.__super__.constructor.apply(this,arguments),this.type="linear",this.duration=0,this.skipDelay=null,this.mediaFiles=[],this.videoClickThroughURLTemplate=null,this.videoClickTrackingURLTemplates=[],this.videoCustomClickURLTemplates=[],this.adParameters=null,this.icons=[]}return h(b,a),b}(d),g=function(a){function b(){b.__super__.constructor.apply(this,arguments),this.type="nonlinear",this.variations=[]}return h(b,a),b}(d),e=function(a){function b(){b.__super__.constructor.apply(this,arguments),this.type="companion",this.variations=[]}return h(b,a),b}(d),b.exports={VASTCreativeLinear:f,VASTCreativeNonLinear:g,VASTCreativeCompanion:e}},{}],6:[function(a,b,c){var d;d=function(){function a(){this.attributes={},this.children=[]}return a}(),b.exports=d},{}],7:[function(a,b,c){var d;d=function(){function a(){this.name=null,this.value=null,this.attributes={}}return a}(),b.exports=d},{}],8:[function(a,b,c){var d;d=function(){function a(){this.program=null,this.height=0,this.width=0,this.xPosition=0,this.yPosition=0,this.apiFramework=null,this.offset=null,this.duration=0,this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.iconClickThroughURLTemplate=null,this.iconClickTrackingURLTemplates=[],this.iconViewTrackingURLTemplate=null}return a}(),b.exports=d},{}],9:[function(a,b,c){b.exports={client:a("./client"),tracker:a("./tracker"),parser:a("./parser"),util:a("./util")}},{"./client":3,"./parser":12,"./tracker":14,"./util":18}],10:[function(a,b,c){var d;d=function(){function a(){this.id=null,this.fileURL=null,this.deliveryType="progressive",this.mimeType=null,this.codec=null,this.bitrate=0,this.minBitrate=0,this.maxBitrate=0,this.width=0,this.height=0,this.apiFramework=null,this.scalable=null,this.maintainAspectRatio=null}return a}(),b.exports=d},{}],11:[function(a,b,c){var d;d=function(){function a(){this.id=null,this.width=0,this.height=0,this.expandedWidth=0,this.expandedHeight=0,this.scalable=!0,this.maintainAspectRatio=!0,this.minSuggestedDuration=0,this.apiFramework="static",this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.nonlinearClickThroughURLTemplate=null,this.nonlinearClickTrackingURLTemplates=[],this.adParameters=null}return a}(),b.exports=d},{}],12:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};e=a("./urlhandler"),q=a("./response"),f=a("./ad"),g=a("./extension"),h=a("./extensionchild"),r=a("./util"),k=a("./creative").VASTCreativeLinear,j=a("./creative").VASTCreativeCompanion,l=a("./creative").VASTCreativeNonLinear,n=a("./mediafile"),m=a("./icon"),i=a("./companionad"),o=a("./nonlinear"),d=a("events").EventEmitter,p=function(){function a(){}var b;return b=[],a.addURLTemplateFilter=function(a){"function"==typeof a&&b.push(a)},a.removeURLTemplateFilter=function(){return b.pop()},a.countURLTemplateFilters=function(){return b.length},a.clearUrlTemplateFilters=function(){return b=[]},a.parse=function(a,b,c){return c||("function"==typeof b&&(c=b),b={}),this._parse(a,null,b,function(a,b){return c(b,a)})},a.load=function(a,b,c){return c||("function"==typeof b&&(c=b),b={}),this.parseXmlDocument(null,[],b,a,c)},a.vent=new d,a.track=function(a,b){return this.vent.emit("VAST-error",b),r.track(a,b)},a.on=function(a,b){return this.vent.on(a,b)},a.once=function(a,b){return this.vent.once(a,b)},a.off=function(a,b){return this.vent.removeListener(a,b)},a._parse=function(a,c,d,f){var g,h,i;for(f||("function"==typeof d&&(f=d),d={}),h=0,i=b.length;h<i;h++)g=b[h],a=g(a);return null==c&&(c=[]),c.push(a),e.get(a,d,function(b){return function(e,g){return null!=e?f(e):b.parseXmlDocument(a,c,d,g,f)}}(this))},a.parseXmlDocument=function(b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,r,t,u,v,w;if(w=new q,null==(null!=e?e.documentElement:void 0)||"VAST"!==e.documentElement.nodeName)return f(new Error("Invalid VAST XMLDocument"));for(u=e.documentElement.childNodes,k=0,n=u.length;k<n;k++)t=u[k],"Error"===t.nodeName&&w.errorURLTemplates.push(a.parseNodeText(t));for(i=[],v=e.documentElement.childNodes,l=0,o=v.length;l<o;l++)t=v[l],"Ad"===t.nodeName&&i.push(t);for(m=0,p=i.length;m<p;m++)h=i[m],g=a.parseAdElement(h),null!=g?(null!=d.wrapperSequence&&null==g.sequence&&1===i.length&&(g.sequence=d.wrapperSequence,d.wrapperSequence=null),w.ads.push(g)):a.track(w.errorURLTemplates,{ERRORCODE:101});for(j=function(error,b){var c,d,e,h;if(null==error&&(error=null),null==b&&(b=!1),w){for(e=!0,h=w.ads,c=0,d=h.length;c<d;c++){if(g=h[c],null!=g.nextWrapperURL)return;g.creatives.length>0&&(e=!1)}return e&&(b||a.track(w.errorURLTemplates,{ERRORCODE:303})),0===w.ads.length&&(w=null,error=new Error("No ads: no valid <inline> has been found")),f(error,w)}},r=w.ads.length;r--;)g=w.ads[r],null!=g.nextWrapperURL&&function(e){var f;c.length>(null!==d.wrapperLimit?d.wrapperLimit:9)||(f=e.nextWrapperURL,s.call(c,f)>=0)?(a.track(e.errorURLTemplates,{ERRORCODE:302}),w.ads.splice(w.ads.indexOf(e),1),j(new Error("Wrapper limit reached, as defined by the video player"))):(null!=b&&(e.nextWrapperURL=a.resolveVastAdTagURI(e.nextWrapperURL,b)),d.wrapperSequence=e.sequence,a._parse(e.nextWrapperURL,c,d,function(b,c){var d,f,g,h,i,k;if(d=!1,null!=b)a.track(e.errorURLTemplates,{ERRORCODE:301}),w.ads.splice(w.ads.indexOf(e),1),d=!0;else if(null==c)a.track(e.errorURLTemplates,{ERRORCODE:303}),w.ads.splice(w.ads.indexOf(e),1),d=!0;else for(w.errorURLTemplates=w.errorURLTemplates.concat(c.errorURLTemplates),f=w.ads.indexOf(e),w.ads.splice(f,1),i=c.ads,g=0,h=i.length;g<h;g++)k=i[g],a.mergeWrapperAdData(k,e),w.ads.splice(++f,0,k);return delete e.nextWrapperURL,j(b,d)}))}(g);return j()},a.resolveVastAdTagURI=function(a,b){return 0===a.indexOf("//")?""+location.protocol+a:-1===a.indexOf("://")?b.slice(0,b.lastIndexOf("/"))+"/"+a:a},a.mergeWrapperAdData=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;for(a.errorURLTemplates=b.errorURLTemplates.concat(a.errorURLTemplates),a.impressionURLTemplates=b.impressionURLTemplates.concat(a.impressionURLTemplates),a.extensions=b.extensions.concat(a.extensions),n=a.creatives,f=0,j=n.length;f<j;f++)if(d=n[f],null!=(null!=(o=b.trackingEvents)?o[d.type]:void 0)){p=b.trackingEvents[d.type];for(e in p)w=p[e],(c=d.trackingEvents)[e]||(c[e]=[]),d.trackingEvents[e]=d.trackingEvents[e].concat(w)}if(null!=(q=b.videoClickTrackingURLTemplates)?q.length:void 0)for(r=a.creatives,g=0,k=r.length;g<k;g++)d=r[g],"linear"===d.type&&(d.videoClickTrackingURLTemplates=d.videoClickTrackingURLTemplates.concat(b.videoClickTrackingURLTemplates));if(null!=(s=b.videoCustomClickURLTemplates)?s.length:void 0)for(t=a.creatives,h=0,l=t.length;h<l;h++)d=t[h],"linear"===d.type&&(d.videoCustomClickURLTemplates=d.videoCustomClickURLTemplates.concat(b.videoCustomClickURLTemplates));if(null!=b.videoClickThroughURLTemplate){for(u=a.creatives,v=[],i=0,m=u.length;i<m;i++)d=u[i],"linear"===d.type&&null==d.videoClickThroughURLTemplate?v.push(d.videoClickThroughURLTemplate=b.videoClickThroughURLTemplate):v.push(void 0);return v}},a.childByName=function(a,b){var c,d,e,f;for(f=a.childNodes,d=0,e=f.length;d<e;d++)if(c=f[d],c.nodeName===b)return c},a.childsByName=function(a,b){var c,d,e,f,g;for(d=[],g=a.childNodes,e=0,f=g.length;e<f;e++)c=g[e],c.nodeName===b&&d.push(c);return d},a.parseAdElement=function(a){var b,c,d,e,f;for(e=a.childNodes,c=0,d=e.length;c<d;c++)if(b=e[c],"Wrapper"===(f=b.nodeName)||"InLine"===f){if(this.copyNodeAttribute("id",a,b),this.copyNodeAttribute("sequence",a,b),"Wrapper"===b.nodeName)return this.parseWrapperElement(b);if("InLine"===b.nodeName)return this.parseInLineElement(b)}},a.parseWrapperElement=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;for(b=this.parseInLineElement(a),x=this.childByName(a,"VASTAdTagURI"),null!=x?b.nextWrapperURL=this.parseNodeText(x):null!=(x=this.childByName(a,"VASTAdTagURL"))&&(b.nextWrapperURL=this.parseNodeText(this.childByName(x,"URL"))),p=b.creatives,f=0,k=p.length;f<k;f++)if(w=p[f],"linear"===(q=w.type)||"nonlinear"===q){if(null!=w.trackingEvents){b.trackingEvents||(b.trackingEvents={}),(c=b.trackingEvents)[o=w.type]||(c[o]={}),r=w.trackingEvents;for(e in r)for(v=r[e],(d=b.trackingEvents[w.type])[e]||(d[e]=[]),h=0,l=v.length;h<l;h++)u=v[h],b.trackingEvents[w.type][e].push(u)}if(null!=w.videoClickTrackingURLTemplates)for(b.videoClickTrackingURLTemplates||(b.videoClickTrackingURLTemplates=[]),s=w.videoClickTrackingURLTemplates,i=0,m=s.length;i<m;i++)g=s[i],b.videoClickTrackingURLTemplates.push(g);if(null!=w.videoClickThroughURLTemplate&&(b.videoClickThroughURLTemplate=w.videoClickThroughURLTemplate),null!=w.videoCustomClickURLTemplates)for(b.videoCustomClickURLTemplates||(b.videoCustomClickURLTemplates=[]),t=w.videoCustomClickURLTemplates,j=0,n=t.length;j<n;j++)g=t[j],b.videoCustomClickURLTemplates.push(g)}if(null!=b.nextWrapperURL)return b},a.parseInLineElement=function(a){var b,c,d,e,g,h,i,j,k,l,m,n,o,p,q;for(b=new f,b.id=a.getAttribute("id")||null,b.sequence=a.getAttribute("sequence")||null,o=a.childNodes,h=0,k=o.length;h<k;h++)switch(n=o[h],n.nodeName){case"Error":b.errorURLTemplates.push(this.parseNodeText(n));break;case"Impression":b.impressionURLTemplates.push(this.parseNodeText(n));break;case"Creatives":for(p=this.childsByName(n,"Creative"),i=0,l=p.length;i<l;i++)for(e=p[i],d={id:e.getAttribute("id")||null,adId:this.parseCreativeAdIdAttribute(e),sequence:e.getAttribute("sequence")||null,apiFramework:e.getAttribute("apiFramework")||null},q=e.childNodes,j=0,m=q.length;j<m;j++)switch(g=q[j],g.nodeName){case"Linear":c=this.parseCreativeLinearElement(g,d),c&&b.creatives.push(c);break;case"NonLinearAds":c=this.parseNonLinear(g,d),c&&b.creatives.push(c);break;case"CompanionAds":c=this.parseCompanionAd(g,d),c&&b.creatives.push(c)}break;case"Extensions":this.parseExtension(b.extensions,this.childsByName(n,"Extension"));break;case"AdSystem":b.system={value:this.parseNodeText(n),version:n.getAttribute("version")||null};break;case"AdTitle":b.title=this.parseNodeText(n);break;case"Description":b.description=this.parseNodeText(n);break;case"Advertiser":b.advertiser=this.parseNodeText(n);break;case"Pricing":b.pricing={value:this.parseNodeText(n),model:n.getAttribute("model")||null,currency:n.getAttribute("currency")||null};break;case"Survey":b.survey=this.parseNodeText(n)}return b},a.parseExtension=function(a,b){var c,d,e,f,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;for(v=[],k=0,o=b.length;k<o;k++){if(i=b[k],d=new g,i.attributes)for(s=i.attributes,l=0,p=s.length;l<p;l++)j=s[l],d.attributes[j.nodeName]=j.nodeValue;for(t=i.childNodes,m=0,q=t.length;m<q;m++)if(c=t[m],w=this.parseNodeText(c),"#comment"!==c.nodeName&&""!==w){if(e=new h,e.name=c.nodeName,e.value=w,c.attributes)for(u=c.attributes,n=0,r=u.length;n<r;n++)f=u[n],e.attributes[f.nodeName]=f.nodeValue;d.children.push(e)}v.push(a.push(d))}return v},a.parseCreativeLinearElement=function(a,b){var c,d,e,f,g,h,i,j,l,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja;if(f=new k(b),f.duration=this.parseDuration(this.parseNodeText(this.childByName(a,"Duration"))),-1===f.duration&&"Wrapper"!==a.parentNode.parentNode.parentNode.nodeName)return null;if(ea=a.getAttribute("skipoffset"),null==ea?f.skipDelay=null:"%"===ea.charAt(ea.length-1)?(Q=parseInt(ea,10),f.skipDelay=f.duration*(Q/100)):f.skipDelay=this.parseDuration(ea),null!=(ja=this.childByName(a,"VideoClicks"))){for(f.videoClickThroughURLTemplate=this.parseNodeText(this.childByName(ja,"ClickThrough")),T=this.childsByName(ja,"ClickTracking"),j=0,w=T.length;j<w;j++)e=T[j],f.videoClickTrackingURLTemplates.push(this.parseNodeText(e));for(U=this.childsByName(ja,"CustomClick"),t=0,x=U.length;t<x;t++)g=U[t],f.videoCustomClickURLTemplates.push(this.parseNodeText(g))}for(c=this.childByName(a,"AdParameters"),null!=c&&(f.adParameters=this.parseNodeText(c)),W=this.childsByName(a,"TrackingEvents"),u=0,z=W.length;u<z;u++)for(ha=W[u],X=this.childsByName(ha,"Tracking"),v=0,A=X.length;v<A;v++)if(ga=X[v],h=ga.getAttribute("event"),ia=this.parseNodeText(ga),null!=h&&null!=ia){if("progress"===h){if(!(O=ga.getAttribute("offset")))continue;h="%"===O.charAt(O.length-1)?"progress-"+O:"progress-"+Math.round(this.parseDuration(O))}null==(d=f.trackingEvents)[h]&&(d[h]=[]),f.trackingEvents[h].push(ia)}for(Y=this.childsByName(a,"MediaFiles"),H=0,B=Y.length;H<B;H++)for(L=Y[H],Z=this.childsByName(L,"MediaFile"),M=0,C=Z.length;M<C;M++)K=Z[M],J=new n,J.id=K.getAttribute("id"),J.fileURL=this.parseNodeText(K),J.deliveryType=K.getAttribute("delivery"),J.codec=K.getAttribute("codec"),J.mimeType=K.getAttribute("type"),J.apiFramework=K.getAttribute("apiFramework"),J.bitrate=parseInt(K.getAttribute("bitrate")||0),J.minBitrate=parseInt(K.getAttribute("minBitrate")||0),J.maxBitrate=parseInt(K.getAttribute("maxBitrate")||0),J.width=parseInt(K.getAttribute("width")||0),J.height=parseInt(K.getAttribute("height")||0),da=K.getAttribute("scalable"),da&&"string"==typeof da&&(da=da.toLowerCase(),"true"===da?J.scalable=!0:"false"===da&&(J.scalable=!1)),I=K.getAttribute("maintainAspectRatio"),I&&"string"==typeof I&&(I=I.toLowerCase(),"true"===I?J.maintainAspectRatio=!0:"false"===I&&(J.maintainAspectRatio=!1)),f.mediaFiles.push(J);if(null!=(r=this.childByName(a,"Icons")))for($=this.childsByName(r,"Icon"),N=0,D=$.length;N<D;N++){for(q=$[N],l=new m,l.program=q.getAttribute("program"),l.height=parseInt(q.getAttribute("height")||0),l.width=parseInt(q.getAttribute("width")||0),l.xPosition=this.parseXPosition(q.getAttribute("xPosition")),l.yPosition=this.parseYPosition(q.getAttribute("yPosition")),l.apiFramework=q.getAttribute("apiFramework"),l.offset=this.parseDuration(q.getAttribute("offset")),l.duration=this.parseDuration(q.getAttribute("duration")),_=this.childsByName(q,"HTMLResource"),P=0,E=_.length;P<E;P++)i=_[P],l.type=i.getAttribute("creativeType")||"text/html",l.htmlResource=this.parseNodeText(i);for(aa=this.childsByName(q,"IFrameResource"),R=0,F=aa.length;R<F;R++)s=aa[R],l.type=s.getAttribute("creativeType")||0,l.iframeResource=this.parseNodeText(s);for(ba=this.childsByName(q,"StaticResource"),S=0,G=ba.length;S<G;S++)fa=ba[S],l.type=fa.getAttribute("creativeType")||0,l.staticResource=this.parseNodeText(fa);if(null!=(p=this.childByName(q,"IconClicks")))for(l.iconClickThroughURLTemplate=this.parseNodeText(this.childByName(p,"IconClickThrough")),V=this.childsByName(p,"IconClickTracking"),ca=0,y=V.length;ca<y;ca++)o=V[ca],l.iconClickTrackingURLTemplates.push(this.parseNodeText(o));l.iconViewTrackingURLTemplate=this.parseNodeText(this.childByName(q,"IconViewTracking")),f.icons.push(l)}return f},a.parseNonLinear=function(a,b){var c,d,e,f,g,h,i,j,k,m,n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L;for(f=new l(b),B=this.childsByName(a,"TrackingEvents"),i=0,p=B.length;i<p;i++)for(K=B[i],C=this.childsByName(K,"Tracking"),k=0,q=C.length;k<q;k++)J=C[k],g=J.getAttribute("event"),L=this.parseNodeText(J),null!=g&&null!=L&&(null==(d=f.trackingEvents)[g]&&(d[g]=[]),f.trackingEvents[g].push(L));for(D=this.childsByName(a,"NonLinear"),m=0,r=D.length;m<r;m++){for(z=D[m],y=new o,y.id=z.getAttribute("id")||null,y.width=z.getAttribute("width"),y.height=z.getAttribute("height"),y.expandedWidth=z.getAttribute("expandedWidth"),y.expandedHeight=z.getAttribute("expandedHeight"),y.scalable=this.parseBoolean(z.getAttribute("scalable")),y.maintainAspectRatio=this.parseBoolean(z.getAttribute("maintainAspectRatio")),y.minSuggestedDuration=this.parseDuration(z.getAttribute("minSuggestedDuration")),y.apiFramework=z.getAttribute("apiFramework"),E=this.childsByName(z,"HTMLResource"),n=0,s=E.length;n<s;n++)h=E[n],y.type=h.getAttribute("creativeType")||"text/html",y.htmlResource=this.parseNodeText(h);for(F=this.childsByName(z,"IFrameResource"),w=0,t=F.length;w<t;w++)j=F[w],y.type=j.getAttribute("creativeType")||0,y.iframeResource=this.parseNodeText(j);for(G=this.childsByName(z,"StaticResource"),x=0,u=G.length;x<u;x++)I=G[x],y.type=I.getAttribute("creativeType")||0,y.staticResource=this.parseNodeText(I);for(c=this.childByName(z,"AdParameters"),null!=c&&(y.adParameters=this.parseNodeText(c)),y.nonlinearClickThroughURLTemplate=this.parseNodeText(this.childByName(z,"NonLinearClickThrough")),H=this.childsByName(z,"NonLinearClickTracking"),A=0,v=H.length;A<v;A++)e=H[A],y.nonlinearClickTrackingURLTemplates.push(this.parseNodeText(e));f.variations.push(y)}return f},a.parseCompanionAd=function(a,b){var c,d,e,f,g,h,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O;for(h=new j(b),D=this.childsByName(a,"Companion"),m=0,r=D.length;m<r;m++){for(g=D[m],f=new i,f.id=g.getAttribute("id")||null,f.width=g.getAttribute("width"),f.height=g.getAttribute("height"),f.companionClickTrackingURLTemplates=[],E=this.childsByName(g,"HTMLResource"),o=0,s=E.length;o<s;o++)l=E[o],f.type=l.getAttribute("creativeType")||"text/html",f.htmlResource=this.parseNodeText(l);for(F=this.childsByName(g,"IFrameResource"),p=0,t=F.length;p<t;p++)n=F[p],f.type=n.getAttribute("creativeType")||0,f.iframeResource=this.parseNodeText(n);for(G=this.childsByName(g,"StaticResource"),q=0,u=G.length;q<u;q++){for(L=G[q],f.type=L.getAttribute("creativeType")||0,H=this.childsByName(g,"AltText"),z=0,v=H.length;z<v;z++)d=H[z],f.altText=this.parseNodeText(d);f.staticResource=this.parseNodeText(L)}for(I=this.childsByName(g,"TrackingEvents"),A=0,w=I.length;A<w;A++)for(N=I[A],J=this.childsByName(N,"Tracking"),B=0,x=J.length;B<x;B++)M=J[B],k=M.getAttribute("event"),O=this.parseNodeText(M),null!=k&&null!=O&&(null==(c=f.trackingEvents)[k]&&(c[k]=[]),f.trackingEvents[k].push(O));for(K=this.childsByName(g,"CompanionClickTracking"),C=0,y=K.length;C<y;C++)e=K[C],f.companionClickTrackingURLTemplates.push(this.parseNodeText(e));f.companionClickThroughURLTemplate=this.parseNodeText(this.childByName(g,"CompanionClickThrough")),f.companionClickTrackingURLTemplate=this.parseNodeText(this.childByName(g,"CompanionClickTracking")),h.variations.push(f)}return h},a.parseDuration=function(a){var b,c,d,e,f;return null==a?-1:r.isNumeric(a)?parseInt(a):(b=a.split(":"),3!==b.length?-1:(f=b[2].split("."),e=parseInt(f[0]),2===f.length&&(e+=parseFloat("0."+f[1])),d=parseInt(60*b[1]),c=parseInt(60*b[0]*60),isNaN(c)||isNaN(d)||isNaN(e)||d>3600||e>60?-1:c+d+e))},a.parseXPosition=function(a){return"left"===a||"right"===a?a:parseInt(a||0)},a.parseYPosition=function(a){return"top"===a||"bottom"===a?a:parseInt(a||0)},a.parseBoolean=function(a){return"true"===a||"TRUE"===a||"1"===a},a.parseNodeText=function(a){return a&&(a.textContent||a.text||"").trim()},a.copyNodeAttribute=function(a,b,c){var d;if(d=b.getAttribute(a))return c.setAttribute(a,d)},a.parseCreativeAdIdAttribute=function(a){return a.getAttribute("AdID")||a.getAttribute("adID")||a.getAttribute("adId")||null},a}(),b.exports=p},{"./ad":2,"./companionad":4,"./creative":5,"./extension":6,"./extensionchild":7,"./icon":8,"./mediafile":10,"./nonlinear":11,"./response":13,"./urlhandler":15,"./util":18,events:1}],13:[function(a,b,c){var d;d=function(){function a(){this.ads=[],this.errorURLTemplates=[]}return a}(),b.exports=d},{}],14:[function(a,b,c){var d,e,f,g,h,i,j,k=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},l={}.hasOwnProperty;e=a("./client"),j=a("./util"),g=a("./creative").VASTCreativeLinear,h=a("./nonlinear"),f=a("./companionad"),d=a("events").EventEmitter,i=function(a){function b(a,b,c){var d,i,j;this.ad=a,this.creative=b,this.variation=null!=c?c:null,this.muted=!1,this.impressed=!1,this.skipable=!1,this.skipDelayDefault=-1,this.trackingEvents={},this.emitAlwaysEvents=["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","resume","pause","rewind","skip","closeLinear","close"],this._alreadyTriggeredQuartiles={},j=this.creative.trackingEvents;for(d in j)i=j[d],this.trackingEvents[d]=i.slice(0);this.creative instanceof g?(this.setDuration(this.creative.duration),this.skipDelay=this.creative.skipDelay,this.linear=!0,this.clickThroughURLTemplate=this.creative.videoClickThroughURLTemplate,this.clickTrackingURLTemplates=this.creative.videoClickTrackingURLTemplates):(this.skipDelay=-1,this.linear=!1,this.variation&&(this.variation instanceof h?(this.clickThroughURLTemplate=this.variation.nonlinearClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.nonlinearClickTrackingURLTemplates):this.variation instanceof f&&(this.clickThroughURLTemplate=this.variation.companionClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.companionClickTrackingURLTemplates))),this.on("start",function(){e.lastSuccessfullAd=+new Date})}return k(b,a),b.off=function(a,b){return this.removeListener(a,b)},b.prototype.setDuration=function(a){return this.assetDuration=a,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100}},b.prototype.setProgress=function(a){var b,c,d,e,f,g,h,i,j;if(i=null===this.skipDelay?this.skipDelayDefault:this.skipDelay,-1===i||this.skipable||(i>a?this.emit("skip-countdown",i-a):(this.skipable=!0,this.emit("skip-countdown",0))),this.linear&&this.assetDuration>0){if(c=[],a>0){c.push("start"),f=Math.round(a/this.assetDuration*100),c.push("progress-"+f+"%"),c.push("progress-"+Math.round(a)),h=this.quartiles;for(g in h)j=h[g],this.isQuartileReached(g,j,a)&&(c.push(g),this._alreadyTriggeredQuartiles[g]=!0)}for(d=0,e=c.length;d<e;d++)b=c[d],this.track(b,!0);a<this.progress&&this.track("rewind")}return this.progress=a},b.prototype.isQuartileReached=function(a,b,c){var d;return d=!1,b<=c&&!this._alreadyTriggeredQuartiles[a]&&(d=!0),d},b.prototype.setMuted=function(a){return this.muted!==a&&this.track(a?"mute":"unmute"),this.muted=a},b.prototype.setPaused=function(a){return this.paused!==a&&this.track(a?"pause":"resume"),this.paused=a},b.prototype.setFullscreen=function(a){return this.fullscreen!==a&&this.track(a?"fullscreen":"exitFullscreen"),this.fullscreen=a},b.prototype.setExpand=function(a){return this.expanded!==a&&this.track(a?"expand":"collapse"),this.expanded=a},b.prototype.setSkipDelay=function(a){if("number"==typeof a)return this.skipDelay=a},b.prototype.load=function(){if(!this.impressed)return this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates),this.track("creativeView")},b.prototype.errorWithCode=function(a){return this.trackURLs(this.ad.errorURLTemplates,{ERRORCODE:a})},b.prototype.complete=function(){return this.track("complete")},b.prototype.close=function(){return this.track(this.linear?"closeLinear":"close")},b.prototype.stop=function(){},b.prototype.skip=function(){return this.track("skip"),this.trackingEvents=[]},b.prototype.click=function(){var a,b,c;if((null!=(b=this.clickTrackingURLTemplates)?b.length:void 0)&&this.trackURLs(this.clickTrackingURLTemplates),null!=this.clickThroughURLTemplate)return this.linear&&(c={CONTENTPLAYHEAD:this.progressFormated()}),a=j.resolveURLTemplates([this.clickThroughURLTemplate],c)[0],this.emit("clickthrough",a)},b.prototype.track=function(a,b){var c,d;null==b&&(b=!1),"closeLinear"===a&&null==this.trackingEvents[a]&&null!=this.trackingEvents.close&&(a="close"),d=this.trackingEvents[a],c=this.emitAlwaysEvents.indexOf(a),null!=d?(this.emit(a,""),this.trackURLs(d)):-1!==c&&this.emit(a,""),!0===b&&(delete this.trackingEvents[a],c>-1&&this.emitAlwaysEvents.splice(c,1))},b.prototype.trackURLs=function(a,b){var c;return null==b&&(b={}),this.linear&&(null!=(null!=(c=this.creative.mediaFiles[0])?c.fileURL:void 0)&&(b.ASSETURI=this.creative.mediaFiles[0].fileURL),b.CONTENTPLAYHEAD=this.progressFormated()),j.track(a,b)},b.prototype.progressFormated=function(){var a,b,c,d,e;return e=parseInt(this.progress),a=e/3600,a.length<2&&(a="0"+a),b=e/60%60,b.length<2&&(b="0"+b),d=e%60,d.length<2&&(d="0"+b),c=parseInt(100*(this.progress-e)),a+":"+b+":"+d+"."+c},b}(d),b.exports=i},{"./client":3,"./companionad":4,"./creative":5,"./nonlinear":11,"./util":18,events:1}],15:[function(a,b,c){var d,e,f;f=a("./urlhandlers/xmlhttprequest"),e=a("./urlhandlers/flash"),d=function(){function b(){}return b.get=function(b,c,d){var g,h;return d||("function"==typeof c&&(d=c),c={}),null!=c.response?(h=c.response,delete c.response,d(null,h)):(null!=(g=c.urlhandler)?g.supported():void 0)?c.urlhandler.get(b,c,d):"undefined"==typeof window||null===window?a("./urlhandlers/node").get(b,c,d):f.supported()?f.get(b,c,d):e.supported()?e.get(b,c,d):d(new Error("Current context is not supported by any of the default URLHandlers. Please provide a custom URLHandler"))},b}(),b.exports=d},{"./urlhandlers/flash":16,"./urlhandlers/xmlhttprequest":17}],16:[function(a,b,c){var d;d=function(){function a(){}return a.xdr=function(){var a;return window.XDomainRequest&&(a=new XDomainRequest),a},a.supported=function(){return!!this.xdr()},a.get=function(a,b,c){var d,e;return(e="function"==typeof window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLDOM"):void 0)?(e.async=!1,d=this.xdr(),d.open("GET",a),d.timeout=b.timeout||0,d.withCredentials=b.withCredentials||!1,d.send(),d.onprogress=function(){},d.onload=function(){return e.loadXML(d.responseText),c(null,e)}):c(new Error("FlashURLHandler: Microsoft.XMLDOM format not supported"))},a}(),b.exports=d},{}],17:[function(a,b,c){var d;d=function(){function a(){}return a.xhr=function(){var a;if("withCredentials"in(a=new window.XMLHttpRequest))return a},a.supported=function(){return!!this.xhr()},a.get=function(a,b,c){var d;if("https:"===window.location.protocol&&0===a.indexOf("http://"))return c(new Error("XHRURLHandler: Cannot go from HTTPS to HTTP."));try{return d=this.xhr(),d.open("GET",a),d.timeout=b.timeout||0,d.withCredentials=b.withCredentials||!1,d.overrideMimeType&&d.overrideMimeType("text/xml"),d.onreadystatechange=function(){if(4===d.readyState)return 200===d.status?c(null,d.responseXML||(new DOMParser).parseFromString(d.response,"text/xml")):c(new Error("XHRURLHandler: "+d.statusText))},d.send()}catch(a){return c(new Error("XHRURLHandler: Unexpected error"))}},a}(),b.exports=d},{}],18:[function(a,b,c){var d;d=function(){function a(){}return a.removePendingEvent=function(a){var b;(b=this.pendingEvents.indexOf(a))>-1&&this.pendingEvents.splice(b,1)},a.pendingEvents=[],a.track=function(a,b){var c,d,e,f,g,h=this;for(d=this.resolveURLTemplates(a,b),g=[],e=0,f=d.length;e<f;e++)c=d[e],"undefined"!=typeof window&&null!==window&&(image=new Image,this.pendingEvents.push(c),image.onload=image.onerror=image.onabort=function(a){return function(){h.removePendingEvent(a)}}(c),g.push(image.src=c));return g},a.resolveURLTemplates=function(a,b){var c,d,e,f,g,h,i,j,k;for(null==b&&(b={}),d=[],null!=b.ASSETURI&&(b.ASSETURI=this.encodeURIComponentRFC3986(b.ASSETURI)),null!=b.CONTENTPLAYHEAD&&(b.CONTENTPLAYHEAD=this.encodeURIComponentRFC3986(b.CONTENTPLAYHEAD)),null==b.ERRORCODE||/^[0-9]{3}$/.test(b.ERRORCODE)||(b.ERRORCODE=900),b.CACHEBUSTING=this.leftpad(Math.round(1e8*Math.random()).toString()),b.TIMESTAMP=this.encodeURIComponentRFC3986((new Date).toISOString()),b.RANDOM=b.random=b.CACHEBUSTING,e=0,g=a.length;e<g;e++)if(c=a[e],j=c){for(f in b)k=b[f],h="["+f+"]",i="%%"+f+"%%",j=j.replace(h,k),j=j.replace(i,k);d.push(j)}return d},a.encodeURIComponentRFC3986=function(a){return encodeURIComponent(a).replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16)})},a.leftpad=function(a){return a.length<8?function(){var b,c,d;for(d=[],b=0,c=8-a.length;0<=c?b<c:b>c;0<=c?b++:b--)d.push("0");return d}().join("")+a:a},a.storage=function(){var a,b,c;try{c="undefined"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(a){a,c=null}return b=function(a){var b;try{if(b="__VASTUtil__",a.setItem(b,b),a.getItem(b)!==b)return!0}catch(a){return a,!0}return!1},(null==c||b(c))&&(a={},c={length:0,getItem:function(b){return a[b]},setItem:function(b,c){a[b]=c,this.length=Object.keys(a).length},removeItem:function(b){delete a[b],this.length=Object.keys(a).length},clear:function(){a={},this.length=0}}),c}(),a.isNumeric=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},a}(),b.exports=d},{}]},{},[9])(9)});var MeetricsTimer=function(a,b){this._repeatCount=b,this._currentCount=0,this._delay=a,this._running=!1,this._timer=null,this._callback=function(a){a._currentCount++,a._running&&a._currentCount<a._repeatCount&&(a._timer=window.setTimeout(function(){a._callback(a)},a._delay))},this.start=function(){if(!this._running){this._running=!0;var a=this;this._timer=window.setTimeout(function(){a._callback(a)},this._delay)}},this.stop=function(){this._running&&(this._running=!1,window.clearTimeout(this._timer),this._timer=null)},this.repeatCount=function(){return this._repeatCount},this.currentCount=function(){return this._currentCount},this.running=function(){return this._running}},MeetricsTracker=function(a){this._stopSent=!1,this._startSent=!1,this.mtrcsCollectorDomain=a.mtrcsCollectorDomain,this.mtrcsProjectID=a.mtrcsProjectID,this.mtrcsCampaign=a.mtrcsCampaign||"",this.mtrcsPlacement=a.mtrcsPlacement||"",this.mtrcsZone=a.mtrcsZone||"",this.mtrcsSite=a.mtrcsSite||"",this.mtrcsCreative=a.mtrcsCreative||"",this.mtrcsAdvertiser=a.mtrcsAdvertiser||"",this.mtrcsParameterA=a.mtrcsParameterA||"",this.mtrcsParameterB=a.mtrcsParameterB||"",this.mtrcsParameterC=a.mtrcsParameterC||"",this.mtrcsParameterD=a.mtrcsParameterD||"",this.mtrcsParameterE=a.mtrcsParameterE||"",this.adDuration=a.adDuration||10,this.mtrcsContainer=document.getElementsByTagName("head")[0],this.mtrcsContainerWindow=this.mtrcsContainer&&this.mtrcsContainer.ownerDocument&&this.mtrcsContainer.ownerDocument.defaultView||window,this.mtrcsWidth=0,this.mtrcsHeight=0,this.mtrcsVolume=0,this.mtrcsAdId=0,this.mtrcsNodeId="",this.mtrcsCallbackName="",this.mtrcsRandomNumber=Math.floor(90000001*Math.random()+1e7),this.mtrcsTrackerVersion=100,this._runningBitmask=0,this._progressSyncer=null,this._eventQueue=new Array,this._callbackStatus=0,this._buffering=!1,this._lastRemaining=-1,this._currentTime=-1,this._currentTimeReported=0,this.mtrcsProtocol="https",this.getScriptUrl=function(){return this.mtrcsProtocol+"://"+this.mtrcsCollectorDomain+"/bb-mx/serve/mtrcs_"+this.mtrcsProjectID+".js#pjid="+this.mtrcsProjectID+"&size=VPAID&place="+this.mtrcsPlacement+"&cpid="+this.mtrcsCampaign+"&site="+this.mtrcsSite+"&cid="+this.mtrcsCreative+"&adc="+this.mtrcsZone+"&adv="+this.mtrcsAdvertiser+"&apa="+this.mtrcsParameterA+"&apb="+this.mtrcsParameterB+"&apc="+this.mtrcsParameterC+"&apd="+this.mtrcsParameterD+"&ape="+this.mtrcsParameterE+"&realsize="+this.mtrcsWidth+"x"+this.mtrcsHeight+"&node="+this.mtrcsNodeId+"&adUnit="+this.mtrcsAdId+"&tm="+this.mtrcsRandomNumber},this.injectMtrcsJS=function(){var a=document.createElement("script");a.async="async",a.src=this.getScriptUrl(),this.mtrcsContainer.appendChild(a),sendDebugData(this.mtrcsProjectID)},this.initAd=function(a,b,c,d){this.mtrcsWidth=a,this.mtrcsHeight=b,this.mtrcsAdId++,this.mtrcsNodeId=d,this.mtrcsCallbackName="mtrcs_vpaid_trigger_"+this.mtrcsProjectID,this.injectMtrcsJS(),this.callMtrcsTrigger(49,this.mtrcsAdId,this.mtrcsTrackerVersion),this.callMtrcsTrigger(42,3,9),this.callMtrcsTrigger(42,18,1),this._stopSent=!1,this._startSent=!1,this._runningBitmask=0,this._progressSyncer=null,this._buffering=!1,this._lastRemaining=-1},this.trackProgressEvents=function(a){var b=0,c=0;1!=a&&7!=a&&47!=a||(c=1),1!=a&&2!=a||(b=1),7!=a&&8!=a||(b=2),47!=a&&48!=a||(b=16),b>0&&(this._runningBitmask=1==c?this._runningBitmask&~b:this._runningBitmask|b,null!=this._progressSyncer&&(0!=this._runningBitmask||this._progressSyncer.running()?this._runningBitmask>0&&this._progressSyncer.running()&&this._progressSyncer.stop():this._progressSyncer.start()))},this._waitForCallback=function(a){if(""!==this.mtrcsCallbackName&&"function"==typeof window[this.mtrcsCallbackName]){a._callbackStatus=2;for(var b=0;b<a._eventQueue.length;b++){var c=a._eventQueue[b];window[this.mtrcsCallbackName](c[0],c[1],c[2],c[3],this.mtrcsRandomNumber)}a._eventQueue=[]}else if(""!==this.mtrcsCallbackName&&this.mtrcsContainerWindow&&"function"==typeof this.mtrcsContainerWindow[this.mtrcsCallbackName]){a._callbackStatus=2;for(var b=0;b<a._eventQueue.length;b++){var c=a._eventQueue[b];this.mtrcsContainerWindow[this.mtrcsCallbackName](c[0],c[1],c[2],c[3],this.mtrcsRandomNumber)}a._eventQueue=[]}else window.setTimeout(function(){a._waitForCallback(a)},200)},this.callMtrcsTrigger=function(a,b,c){var d=(new Date).getTime();if(2==a){if(this._stopSent)return;this._stopSent=!0}if(1==a){if(this._startSent)return;this._startSent=!0}if(""!==this.mtrcsCallbackName&&"function"==typeof window[this.mtrcsCallbackName])window[this.mtrcsCallbackName](a,b,c,d,this.mtrcsRandomNumber);else if(""!==this.mtrcsCallbackName&&this.mtrcsContainerWindow&&"function"==typeof this.mtrcsContainerWindow[this.mtrcsCallbackName])this.mtrcsContainerWindow[this.mtrcsCallbackName](a,b,c,d,this.mtrcsRandomNumber);else if(this._eventQueue.push([a,b,c,d]),0==this._callbackStatus){this._callbackStatus=1;var e=this;window.setTimeout(function(){e._waitForCallback(e)},200)}this.trackProgressEvents(a)},this._progressDelay=function(a){if(!this._buffering&&a>100){this._buffering=!0,this.callMtrcsTrigger(48);var b=this;window.setTimeout(function(){b._buffering=!1,b.callMtrcsTrigger(47)},a)}},this.syncProgress=function(a){if(null==this._progressSyncer)a>0&&(this._progressSyncer=new MeetricsTimer(1e3,a+10),this._progressSyncer.start(),this.callMtrcsTrigger(42,6,Math.floor(a)));else{var b=this._progressSyncer.repeatCount()-this._progressSyncer.currentCount()-10;a>b+1?this._progressDelay(1e3*(a-b)):b>a&&a<this._lastRemaining&&this._runningBitmask>0&&(2==(2&this._runningBitmask)?this.callMtrcsTrigger(7):16==(16&this._runningBitmask)&&this.callMtrcsTrigger(47))}this._lastRemaining=a},this.reportOffset=function(a){var b=Math.round(1e3*a),c=(new Date).getTime();b!==this._currentTime&&c>this._currentTimeReported+500&&(this.callMtrcsTrigger(42,11,b),this._currentTime=b,this._currentTimeReported=c)},this.adVolume=function(a){this.mtrcsVolume=a,this.callMtrcsTrigger(46,Math.floor(100*a))},this.resizeAd=function(a,b){this.mtrcsWidth=a,this.mtrcsHeight=b,this.callMtrcsTrigger(12,a)},this.startAd=function(){this.callMtrcsTrigger(1)},this.stopAd=function(){this.callMtrcsTrigger(2)},this.pauseAd=function(){this.callMtrcsTrigger(8)},this.resumeAd=function(){this.callMtrcsTrigger(7)},this.expandAd=function(){this.callMtrcsTrigger(13,11)},this.collapseAd=function(){this.callMtrcsTrigger(13,12)},this.clickAd=function(){this.callMtrcsTrigger(9)},this.sendQuartile=function(a){this.callMtrcsTrigger(42,2,a)},this.enterFullscreen=function(){this.callMtrcsTrigger(53)},this.leaveFullscreen=function(){this.callMtrcsTrigger(54)}},sendDebugData=function(a){function b(b){var c,d;d="https://dbg01.meetrics.net/put?pjid="+a,c=new XMLHttpRequest,c.open("POST",d),c.setRequestHeader("Content-Type","text/plain"),c.send(b)}function c(a,window,document){try{a.push("VPAID on top: "+top===window),a.push("Document"),a.push("has head: "+!!document.head),a.push("has body: "+!!document.body),a.push("has frameset: "+!!document.getElementsByTagName("frameset")[0]),a.push("Window"),a.push("has phantom: "+window._phantom),a.push("has nightmare: "+window.__nightmare),a.push("has webdriver: "+window.webdriver)}catch(b){a.push("Sync debug threw error: "+b.message)}}function d(b,window,document){var c,d,e;try{for(c=window.de_meetrics&&window.de_meetrics[a],b.push("has de_meetrics: "+!!c),c&&(b.push("cflag: "+c.cflag),b.push("runonce: "+c.runonce)),d=document.getElementsByTagName("script"),b.push("Scripts:"),e=0;e<d.length;e++)b.push(d[e].src)}catch(a){b.push("Async debug threw error: "+a.message)}}var e;e=[];var f=function(a){var b;for(a=a||document;b=g(a);)a=b.document;return a},f=function(a){var b;for(a=a||document;b=g(a);)a=b.document;return a},g=function(a){var b,c;if(a&&a!==c&&a.defaultView!==top&&a.parentWindow!==top)try{if(b=a.defaultView&&a.defaultView.parent||a.parentWindow&&a.parentWindow.parent,b.document)return b}catch(a){}};-1!==window.location.href.indexOf("videovalis.tv")&&(f(),c(e,window,document),setTimeout(function(){var a;for(d(e,window,document),a=g(document);a;)c(e,a,a.document),d(e,a,a.document),a===top&&e.push("Top window reached"),a=g(a.document);e.push("##########################################"),b(e.join("\n"))},3e3))},MeetricsVPAID=function(){};MeetricsVPAID.prototype=function(){function a(a){function b(a){for(var b="",c=a.length-1;c>=0;c--)if(b=a[c].src,-1!==b.toLowerCase().search("meetricsproxy")||-1!==b.toLowerCase().search("mtrcs"))return b.replace(/^[^\?]+\??/,"");return""}var c=a[a.length-1].src.replace(/^[^\?]+\??/,"");return-1!==c.toLowerCase().search("meetricsproxy")?c:b(a)}this.doc=document,this.vpaidAd=null,this.mediaFileParams=a(doc.getElementsByTagName("script"));var b=function(){return{RELEASE_DATE:"11.01.2017",HANDSHAKE_VERSION:"2.0",UI_COMPONENTS_PATH:"https://s418.mxcdn.net/bb-serve/vpaid_js/ui/",FONT_NAME:"Helvetica, Arial, sans-serif",FONT_SIZE:15,FONT_COLOR:"#FFFFFF",FONT_BACKGROUND_COLOR:"rgba(000,0,0,.5)",FONT_BACKGROUND_HEIGHT:25,meetricsDebug:!1,meetricsTimeout:3e3,meetricsPreferedMedia:null,meetricsMuteButton:!1,meetricsFullscreenButton:!1,meetricsPlayButton:!1,meetricsShowSkipAfter:-1,meetricsLanguage:"EN",meetricsCountdown:!1,meetricsProxy:null,meetricsProxyEncoded:null,meetricsVolume:-1,adParameters:{},mtrcsCollectorDomain:void 0,mtrcsProjectID:123,mtrcsCampaign:1,mtrcsPlacement:3,mtrcsZone:5,mtrcsSite:null,mtrcsCreative:4,mtrcsAdvertiser:null,mtrcsParameterA:null,mtrcsParameterB:null,mtrcsParameterC:null,mtrcsParameterD:null,mtrcsParameterE:null,adDuration:20,mtrcsWidth:640,mtrcsHeight:480,mtrcsVolume:1,mtrcsShowPause:null,videoSlot:null,slot:null,width:null,height:null,viewMode:null,desiredBitrate:null,creativeData:null,specialAdParameters:null,environmentVars:null,playerEventsCallback:{},playerWrapper:null,vpaidInterface:null,vpaidAd:null,TOGGLE_PLAY_POS:{x:function(){return 10},y:function(){return-30}},TOGGLE_MUTE_POS:{x:function(){return 50},y:function(){return-30}},TOGGLE_FS_POS:{x:function(){return 90},y:function(){return-30}},SKIP_POS:{x:function(){return-40},y:function(){return-50}},paramNames:{ADDITIONAL_VAST_TO_PARSE:"additional_vast_to_parse",MEETRICS_PROXY:"meetricsProxy",MEETRICS_PROXY_ENCODED:"meetricsProxyEncoded",MEETRICS_DEBUG:"meetricsDebug",MEETRICS_TIMEOUT:"meetricsTimeout",MEETRICS_PREFERED_MEDIA:"meetricsPreferedMedia",MEETRICS_MUTE_BUTTON:"meetricsMuteButton",MEETRICS_FULLSCREEN_BUTTON:"meetricsFullscreenButton",MEETRICS_PLAY_BUTTON:"meetricsPlayButton",MEETRICS_SHOW_SKIP_AFTER:"meetricsShowSkipAfter",MEETRICS_LANGUAGE:"meetricsLanguage",MEETRICS_COUNTDOWN:"meetricsCountdown",MEETRICS_VOLUME:"meetricsVolume"}}}(),c=function(){return{EN_COUNTDOWN:"Advertising - Your video in",EN_SKIP_COUNTDOWN:"You can skip to video in",EN_SKIP_BUTTON:"Skip",EN_SINGULAR:"second",EN_PLURAL:"seconds",DE_COUNTDOWN:"Werbung - Ihr Video beginnt in",DE_SKIP_COUNTDOWN_PREPOSITION:"In",DE_SKIP_COUNTDOWN:"kannst du zum Video wechseln",DE_SKIP_BUTTON:"&Uuml;berspringen",DE_SINGULAR:"Sekunde",DE_PLURAL:"Sekunden",FR_COUNTDOWN:"Publicit&eacute; - Votre vid&eacute;o dans",FR_SKIP_COUNTDOWN:"Vous pouvez passer &agrave; la video en",FR_SKIP_BUTTON:"Ignorer l'annonce",FR_SINGULAR:"seconde",FR_PLURAL:"secondes",SV_COUNTDOWN:"Klippet startar om",SV_SKIP_COUNTDOWN:"Du kan starta klippet direkt om",SV_SKIP_BUTTON:"Hoppa &ouml;ver annonsen",SV_SINGULAR:"sekunde",SV_PLURAL:"sekunder",PL_COUNTDOWN:"Reklama - Twoje video zacznie siÄ™ za",PL_SKIP_COUNTDOWN:"MoÅ¼esz pominÄ…Ä‡ tÄ™ reklamÄ™ za",PL_SKIP_BUTTON:"PomiÅ„ reklamÄ™",PL_SINGULAR:"sekundÄ™",PL_PLURAL:"sekund"}}(),d=function(){function a(a,b,c,e){var f,g=!1,h=d.createElement("script");h.setAttribute("src",a),f=setTimeout(function(){g||c({type:"timeout_error"})},e),h.onreadystatechange=h.onload=function(){clearTimeout(f),g=!0,b(window)},d.getElementsByTagName("head")[0].appendChild(h)}function b(a,b,c,e){var f,g=!1,h=d.createElement("iframe");h.width=0,h.height=0,h.style.display="none",d.body.appendChild(h);var i=h.contentDocument,j=i.createElement("script");j.setAttribute("src",a),f=setTimeout(function(){g||c({type:"timeout_error"})},e),j.onreadystatechange=j.onload=function(){clearTimeout(f),g=!0,b(h.contentWindow)},i.body.appendChild(j)}function c(a,b,c,d,e){var f,g=!1;f=setTimeout(function(){g||c({type:"timeout_error"})},d),DMVAST.client.get(a,{withCredentials:e},function(a){clearTimeout(f),g=!0,a?b(a):c({type:"no_ads_error"})})}var d=document;return{loadXML:c,loadJS:a,loadJSIntoIframe:b}}(),e=function(){return{findParam:function(a,b,c){var d=null,e=MeetricsVPAID.prototype.model.config;return(d=b.split(c+"=")[1])&&""!==d?c==e.paramNames.MEETRICS_PROXY||c==e.paramNames.MEETRICS_PROXY_ENCODED?d.split("&meetrics")[0]:d.split("&")[0]:(d=a.mtrcsData,d&&d.hasOwnProperty(c)?d[c]:e[c])},unescapeParam:function(a,b,c){return this.findParam(a,unescape(b),c)},findMediaFileIndex:function(a,b){for(var c=a.length,d=0;d<c;d++)if(-1!==a[d].mimeType.indexOf(b))return d;return 0},findBestMediaFileIndex:function(a,b){var c=a.length,d=0,e=-1;if(b){b.indexOf(":")>=0&&(d=parseInt(b.substr(b.indexOf(":")+1)),isNaN(d)&&(d=0),b=b.substr(0,b.indexOf(":")));for(var f=0;f<c;f++)if(-1!==a[f].mimeType.indexOf(b)){if(!(d>0))return f;e=f,d--}if(e>=0)return e}for(f=0;f<c;f++)if(-1===a[f].mimeType.indexOf("x-shockwave-flash")&&-1===a[f].mimeType.indexOf("flv"))return f;return 0},objectToString:function(a){var b="";for(var c in a)a.hasOwnProperty(c)&&(b+=c+":"+a[c]+",");return b},objectToLowerCase:function(a){if(a){for(var b,c=Object.keys(a),d=c.length,e={};d--;)b=c[d],e[b.toLowerCase()]=a[b];return e}},isVideo:function(a){try{return"video"===a.tagName.toLowerCase()}catch(a){return!1}},isIE:function(){try{return-1!==navigator.userAgent.search(/Trident|MSIE/g)}catch(a){return!1}},isIOS:function(){try{return/iPad|iPhone|iPod/.test(navigator.platform)}catch(a){return!1}},isFullscreen:function(a){return a.fullscreenElement||a.webkitFullscreenElement||a.mozFullScreenElement},onFullscreen:function(a,b){a.addEventListener("fullscreenchange",b),a.addEventListener("mozfullscreenchange",b),a.addEventListener("webkitfullscreenchange",b)},requestFullscreen:function(a){if(a.requestFullscreen)a.requestFullscreen();else if(a.msRequestFullscreen)a.msRequestFullscreen();else if(a.mozRequestFullScreen)a.mozRequestFullScreen();else if(a.webkitRequestFullscreen)a.webkitRequestFullscreen();else{if(!a.webkitEnterFullscreen)return!1;a.webkitEnterFullscreen()}return!0},exitFullscreen:function(a){var b=a.ownerDocument||document;if(b.exitFullscreen)b.exitFullscreen();else if(b.msExitFullscreen)b.msExitFullscreen();else if(b.mozCancelFullScreen)b.mozCancelFullScreen();else{if(!b.webkitExitFullscreen)return!1;b.webkitExitFullscreen()}return!0}}}(),f=function(){function a(){return-1!==c.toLowerCase().search("meetricsdebug=true")||(!!(navigator&&navigator.userAgent&&navigator.userAgent.indexOf("mtrcsVpaidDebug")>=0)||!!(document&&document.cookie&&document.cookie.indexOf("mtrcsVpaidDebug=true")>=0))}function b(a,b,c,e){if(d)return void 0===c?void console.log(b):void(void 0!==MeetricsVPAID&&MeetricsVPAID.prototype.utils.helpers.isIE()?console.log(a+" [module "+b+"] : "+c):console.log("%c "+a+" %c "+b,"color:#FFFFFF; background:"+e+";","color:#000000; background:#C8C8C8;",c))}var c=(document,window.location.search),d=a();return{getEnable:function(){return d},enable:function(a){d=a},out:function(a,c,d){b("LOG",a,c,d||"#FF33CC")},error:function(a,c,d){b("ERROR",a,c,d||"#FF0000")},event:function(a,c,d){b("EVENT",a,c,d||"#0066FF")},info:function(a,c,d){b("INFO",a,c,d||"#009933")},track:function(a,c,d){b("TRACK",a,c,d||"#FF9933")}}}(),g=function(){function a(a){h=MeetricsVPAID.prototype.utils.log,h.out("BigPlayBtn","build","#00CC00"),g=MeetricsVPAID.prototype.model.config,n=MeetricsVPAID.prototype.utils.helpers,i=g.slot,l=MeetricsVPAID.prototype.core.videoManager,j=l.getAdHeight(),m=a,k=o.createElement("div"),b(),k.addEventListener("click",f),i.appendChild(k),m.addEventListener("play",d),m.addEventListener("pause",e)}function b(){k.id="BigPlayBtn",k.style.cssFloat="right",k.style.width="250px",k.style.height="250px",k.style.position="absolute",k.style.top="0px",k.style.left="0px",k.style.right="0px",k.style.bottom="0px",k.style.margin="auto",c(!1),k.insertAdjacentHTML("beforeend",'                <svg                     style="width: 100%; height: 100%; position: absolute;top: 0;left: 0;                           box-sizing: border-box; opacity: 0.95;                           cursor: pointer;"                    viewBox="0 0 200 200" >                    <circle cx="100" cy="100" r="90" fill="none" stroke-width="15" stroke="#fff"/>                    <polygon points="70, 55 70, 145 145, 100" fill="#fff"/>                </svg>            ')}function c(a){k.style.display=a?"block":"none"}function d(){c(!1)}function e(){c(!0)}function f(a){h.out("BigPlayBtn","onClick","#00CC00"),m.paused?(l.resumeAd(),c(!1)):(l.pauseAd(),c(!0)),a.stopPropagation()}var g,h,i,j,k,l,m,n,o=document;return{build:a,toggleBtn:c}}(),h=function(){function a(){d=MeetricsVPAID.prototype.utils.log,d.out("CountdownAd","build","#00CC00"),c=MeetricsVPAID.prototype.model.config,p=c.meetricsLanguage,i=MeetricsVPAID.prototype.model.language,q=MeetricsVPAID.prototype.core.videoManager,o=q.getAdDuration(),k=MeetricsVPAID.prototype.utils.helpers,e=c.slot,f=q.getAdWidth(),j=i[p+"_COUNTDOWN"],l=i[p+"_SINGULAR"],m=i[p+"_PLURAL"],h=r.createElement("div"),h.style.backgroundColor=c.FONT_BACKGROUND_COLOR,h.style.height=c.FONT_BACKGROUND_HEIGHT+"px",h.style.width=f+"px",h.style.position="absolute",h.style.top="0px",h.style.left="0px",g=r.createElement("div"),g.style.cssFloat="left",g.style.width=f+"px",g.style.padding="5px",g.style.color=c.FONT_COLOR,g.style.fontFamily=c.FONT_NAME,g.style.fontSize=c.FONT_SIZE+"px",n=1===o?l:m,g.innerHTML=" "+j+" "+o+" "+n+" ",h.appendChild(g),e.appendChild(h)}function b(){var a=Math.round(q.getAdRemainingTime());n=1===a?l:m,g.innerHTML=" "+j+" "+a+" "+n+" ",d.out("CountdownAd","update countdown: "+a,"#00CC00")}var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=document;return{build:a,update:b}}(),i=function(){function a(){switch(f=MeetricsVPAID.prototype.utils.log,f.out("CountdownSkip","build","#00CC00"),e=MeetricsVPAID.prototype.model.config,s=MeetricsVPAID.prototype.utils.helpers,g=e.slot,h=MeetricsVPAID.prototype.core.videoManager,o=h.getAdWidth(),i=e.meetricsLanguage,k=MeetricsVPAID.prototype.model.language,m=e.meetricsShowSkipAfter,n=k[i+"_SKIP_COUNTDOWN"],l=t.createElement("div"),r=t.createElement("div"),i){case"DE":p=120,q=250,j=k.DE_SKIP_COUNTDOWN_PREPOSITION,l.innerHTML=j+" "+m+" "+n;break;case"FR":p=140,q=250,l.innerHTML=n+" "+m;break;case"SV":p=180,q=300,l.innerHTML=n+" "+m+" "+(Number(e.meetricsShowSkipAfter)>1?k.SV_PLURAL:k.SV_SINGULAR);break;case"PL":p=120,q=250,l.innerHTML=n+" "+m;break;default:p=60,q=190,l.innerHTML=n+" "+m}if(l.style.height="20px",l.style.width=q+"px",l.style.padding="5px",l.style.color=e.FONT_COLOR,l.style.fontFamily=e.FONT_NAME,l.style.fontSize=e.FONT_SIZE+"px",r.style.backgroundColor=e.FONT_BACKGROUND_COLOR,r.style.position="absolute",r.style.height=e.FONT_BACKGROUND_HEIGHT+"px",r.style.width=q+"px",r.style.top=e.height+e.SKIP_POS.y()+"px",r.style.left=e.width-q+"px",r.appendChild(l),g.appendChild(r),0===Number(e.meetricsShowSkipAfter))return void b()}function b(){l.innerHTML=k[i+"_SKIP_BUTTON"]+"&nbsp;&raquo;",l.style.textDecoration="underline",l.style.cursor="pointer",l.style.width=p+"px",r.style.left=e.width-p+"px",l.addEventListener("click",d)}function c(){0!==e.meetricsShowSkipAfter&&(m--,m>0?l.innerHTML="DE"===i?j+" "+m+" "+n:"SV"===i?n+" "+m+" "+(Number(e.meetricsShowSkipAfter)>1?k.SV_PLURAL:k.SV_SINGULAR):n+" "+m:0===m&&(b(),h.setAdSkippableState(!0)))}function d(a){f.out("CountdownSkip","onClick","#00CC00"),h.skipAd(),a.stopPropagation()}var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=document;return{build:a,update:c}}(),j=function(){function a(a){e=MeetricsVPAID.prototype.utils.log,k=MeetricsVPAID.prototype.utils.helpers,e.out("FullscreenBtn","build","#00CC00"),d=MeetricsVPAID.prototype.model.config,f=d.slot,i=MeetricsVPAID.prototype.core.videoManager,g=i.getAdHeight(),j=a,j.ownerDocument?m=j.ownerDocument:j._element.ownerDocument&&(m=j._element.ownerDocument),h=l.createElement("div"),h.style.cssFloat="right",h.style.width="25px",h.style.height="25px",h.style.position="absolute",h.style.top=g+d.TOGGLE_FS_POS.y()+"px",h.style.left=d.TOGGLE_FS_POS.x()+"px",h.addEventListener("click",c),f.appendChild(h),k.onFullscreen(m,b),b()}function b(){var a=k.isFullscreen(m)?"ns_btn.png":"fs_btn.png";h.style.background="url('"+d.UI_COMPONENTS_PATH+a+"') no-repeat right top"}function c(a){var c;e.out("FullscreenBtn","onClick","#00CC00"),k.isFullscreen(m)?(k.exitFullscreen(m),i.setAdExpanded(!1)):(c=k.requestFullscreen(j),!c&&j._element&&(c=k.requestFullscreen(j._element)),i.setAdExpanded(!0)),b(),a.stopPropagation()}var d,e,f,g,h,i,j,k,l=document,m=window.document;return{build:a}}(),k=function(){function a(a){if(g=MeetricsVPAID.prototype.utils.log,k=MeetricsVPAID.prototype.utils.helpers,g.out("MuteBtn","build","#00CC00"),k.isIOS())return void g.error("MuteBtn","device does not support Mute Btn");f=MeetricsVPAID.prototype.model.config,h=f.slot,j=MeetricsVPAID.prototype.core.videoManager,l=a,m=0===l.volume?1:l.volume,i=n.createElement("div"),i.id="muteBtn",i.style.zIndex=1,i.style.cssFloat="right",i.style.width="25px",i.style.height="25px",i.style.position="absolute",i.style.top=j.getAdHeight()+f.TOGGLE_MUTE_POS.y()+"px",i.style.left=f.TOGGLE_MUTE_POS.x()+"px",i.addEventListener("click",e),h.appendChild(i),l.addEventListener("volumechange",d),d()}function b(){return l._element&&l._element.volume?l._element.volume:l.volume}function c(a){l._element&&l._element.volume?l._element.volume=a:l.volume=a}function d(){var a=!l.muted&&b()>0?"unmute_btn.png":"mute_btn.png";i.style.background="url('"+f.UI_COMPONENTS_PATH+a+"') no-repeat right top",MeetricsVPAID.prototype.core.videoManager.setAdVolume(b())}function e(a){g.out("MuteBtn","onClick","#00CC00"),MeetricsVPAID.prototype.core.videoManager.setOkToUnmute(),!l.muted&&b()>0?(m=b(),c(0)):(l.muted=!1,c(m)),d(),a.stopPropagation()}var f,g,h,i,j,k,l,m,n=document;return{build:a}}(),l=function(){function a(a){g=MeetricsVPAID.prototype.utils.log,g.out("PlayBtn","build","#00CC00"),f=MeetricsVPAID.prototype.model.config,m=MeetricsVPAID.prototype.utils.helpers,h=f.slot,k=MeetricsVPAID.prototype.core.videoManager,i=k.getAdHeight(),l=a,j=n.createElement("div"),j.id="PlayBtn",j.style.cssFloat="right",j.style.width="25px",j.style.height="25px",j.style.position="absolute",j.style.top=i+f.TOGGLE_PLAY_POS.y()+"px",j.style.left=f.TOGGLE_PLAY_POS.x()+"px",j.addEventListener("click",e),h.appendChild(j),l.addEventListener("play",b),l.addEventListener("pause",c),d(!0===l.paused)}function b(){d(!1)}function c(){d(!0)}function d(a){var b=a?"play_btn.png":"pause_btn.png";j.style.background="url('"+f.UI_COMPONENTS_PATH+b+"') no-repeat right top"}function e(a){g.out("PlayBtn","onClick","#00CC00"),l.paused?(k.resumeAd(),d(!1)):(k.pauseAd(),d(!0)),a.stopPropagation()}var f,g,h,i,j,k,l,m,n=document;return{build:a}}(),m=function(){function a(a,d,e,f,g,l,m){i=this.model.config,j=this.utils.helpers,k=this.utils.log,core=this.core,i.slot=l.slot,i.videoSlot=l.videoSlot;var n=this.model.mediaFileParams,o=k.getEnable(),p={},q=i.slot.parentElement;i.slot;q.style.overflow="hidden";try{var r=window.frameElement;r.frameBorder=0,r.style.border=0,r.setAttribute("allowFullScreen","")}catch(a){}try{p=JSON.parse(g.AdParameters)}catch(a){console.log("Meetrics ProxyManager fail to parse AdParameters JSON (missing or not correct formatted): "+a)}!1===o&&(o="true"===j.findParam(p,n,i.paramNames.MEETRICS_DEBUG),k.enable(o)),i.vpaidInterface=m,i.width=a,i.height=d,i.viewMode=e,i.desiredBitrate=f,i.creativeData=g,i.environmentVars=l;try{i.meetricsProxy=j.findParam(p,n,i.paramNames.MEETRICS_PROXY),p.hasOwnProperty(i.paramNames.ADDITIONAL_VAST_TO_PARSE)&&(i.meetricsProxy="data:text/xml,"+p[i.paramNames.ADDITIONAL_VAST_TO_PARSE]),i.meetricsProxyEncoded=j.unescapeParam(p,n,i.paramNames.MEETRICS_PROXY_ENCODED),i.meetricsTimeout=parseInt(j.findParam(p,n,i.paramNames.MEETRICS_TIMEOUT)),i.meetricsPreferedMedia=j.findParam(p,n,i.paramNames.MEETRICS_PREFERED_MEDIA),i.meetricsMuteButton="true"===j.findParam(p,n,i.paramNames.MEETRICS_MUTE_BUTTON),i.meetricsFullscreenButton="true"===j.findParam(p,n,i.paramNames.MEETRICS_FULLSCREEN_BUTTON),i.meetricsPlayButton="true"===j.findParam(p,n,i.paramNames.MEETRICS_PLAY_BUTTON),i.meetricsShowSkipAfter=parseInt(j.findParam(p,n,i.paramNames.MEETRICS_SHOW_SKIP_AFTER)),i.meetricsLanguage=j.findParam(p,n,i.paramNames.MEETRICS_LANGUAGE),i.meetricsCountdown="true"===j.findParam(p,n,i.paramNames.MEETRICS_COUNTDOWN),i.meetricsVolume=parseInt(j.findParam(p,n,i.paramNames.MEETRICS_VOLUME)),i.mtrcsCollectorDomain=j.findParam(p,n,"mtrcsCollectorDomain"),i.mtrcsProjectID=j.findParam(p,n,"mtrcsProjectID"),i.mtrcsCampaign=j.findParam(p,n,"mtrcsCampaign"),i.mtrcsPlacement=j.findParam(p,n,"mtrcsPlacement"),i.mtrcsZone=j.findParam(p,n,"mtrcsZone"),i.mtrcsSite=j.findParam(p,n,"mtrcsSite"),i.mtrcsCreative=j.findParam(p,n,"mtrcsCreative"),i.mtrcsAdvertiser=j.findParam(p,n,"mtrcsAdvertiser"),i.mtrcsParameterA=j.findParam(p,n,"mtrcsParameterA"),i.mtrcsParameterB=j.findParam(p,n,"mtrcsParameterB"),i.mtrcsParameterC=j.findParam(p,n,"mtrcsParameterC"),i.mtrcsParameterD=j.findParam(p,n,"mtrcsParameterD"),i.mtrcsParameterE=j.findParam(p,n,"mtrcsParameterE"),i.mtrcsVolume=j.findParam(p,n,"mtrcsVolume"),i.mtrcsShowPause=j.findParam(p,n,"mtrcsShowPause"),i.mtrcsWidth=i.width,i.mtrcsHeight=i.height,""===i.meetricsLanguage&&(i.meetricsCountdown=!1,i.meetricsShowSkipAfter=-1)}catch(a){k.error("ProxyManager","fail to parse meetrics option params: "+a)}var s="";s+="\n=======================================================",s+="\ninit Meetrics VPAID JS Proxy | release: "+i.RELEASE_DATE,s+="\n======================= config ========================",s+="\nmeetricsProxy: "+i.meetricsProxy,s+="\nmeetricsProxyEncoded: "+i.meetricsProxyEncoded,s+="\nmeetricsdebug: "+o,s+="\nmeetricsTimeout: "+i.meetricsTimeout,s+="\nmeetricsPreferedMedia: "+i.meetricsPreferedMedia,s+="\nmeetricsMuteButton: "+i.meetricsMuteButton,s+="\nmeetricsFullscreenButton: "+i.meetricsFullscreenButton,s+="\nmeetricsPlayButton: "+i.meetricsPlayButton,s+="\nmeetricsShowSkipAfter: "+i.meetricsShowSkipAfter,s+="\nmeetricsLanguage: "+i.meetricsLanguage,s+="\nmeetricsCountdown: "+i.meetricsCountdown,s+="\nmeetricsVolume: "+i.meetricsVolume,s+="\nnodeId: "+i.videoSlot.id,s+="\nmtrcsCollectorDomain: "+i.mtrcsCollectorDomain,s+="\nmtrcsProjectID: "+i.mtrcsProjectID,s+="\nmtrcsCampaign: "+i.mtrcsCampaign,s+="\nmtrcsPlacement: "+i.mtrcsPlacement,s+="\nmtrcsZone: "+i.mtrcsZone,s+="\nmtrcsSite: "+i.mtrcsSite,s+="\nmtrcsCreative: "+i.mtrcsCreative,s+="\nmtrcsAdvertiser: "+i.mtrcsAdvertiser,s+="\nmtrcsParameterA: "+i.mtrcsParameterA,s+="\nmtrcsParameterB: "+i.mtrcsParameterB,s+="\nmtrcsParameterC: "+i.mtrcsParameterC,s+="\nmtrcsParameterD: "+i.mtrcsParameterD,s+="\nmtrcsParameterE: "+i.mtrcsParameterE,s+="\nmtrcsWidth: "+i.width,s+="\nmtrcsHeight: "+i.height,s+="\nmtrcsVolume: "+i.mtrcsVolume,s+="\nmtrcsShowPause: "+i.mtrcsShowPause,s+="\n================= VPAID.initAd() config ===============",s+="\nwidth: "+i.width,s+="\nheight: "+i.height,s+="\nviewMode: "+i.viewMode,s+="\ndesiredBitrate: "+i.desiredBitrate,s+="\ncreativeData: "+j.objectToString(g),s+="\nenvironmentVars: "+j.objectToString(l),s+="\n========================================================",k.out(s);var t=i.meetricsProxy?i.meetricsProxy:i.meetricsProxyEncoded,u=!0;p.hasOwnProperty(i.paramNames.ADDITIONAL_VAST_TO_PARSE)&&(u=!1),t?(k.out("ProxyManager","try to load VAST XML URL: "+t),this.utils.assetLoader.loadXML(t,c,b,i.meetricsTimeout,u)):(k.error("ProxyManager","fail to find meetricsProxy or meetricsProxyEncoded URI"),trackEvent("AdError"),h("AdStopped"))}function b(a){k.error("ProxyManager","VAST Load Fail: "+a.type),h("AdError"),h("AdStopped")}function c(a){k.out("ProxyManager","load VAST success");for(var b=a.ads[0],c=0,d=b.creatives.length;c<d;c++){var f=b.creatives[c];if("linear"===f.type){e(b,f);break}}}function d(a,b){var c,d,e,f;if(a,!a)return b;if(!b)return a;try{c=JSON.parse(a)}catch(a){}try{d=JSON.parse(b)}catch(a){}if(!c)return b;if(!d)return b.length>0&&(i.specialAdParameters=b),a;f=0;for(e in c)c.hasOwnProperty(e)&&!d.hasOwnProperty(e)&&(f++,d[e]=c[e]);return f>0?JSON.stringify(d):b}function e(a,b){var c=0;c=j.findBestMediaFileIndex(b.mediaFiles,i.meetricsPreferedMedia);var e=b.mediaFiles[c];i.adDuration=b.duration,f(a.extensions),i.specialAdParameters=null;try{var g=d(i.creativeData.AdParameters,b.adParameters);i.creativeData.AdParameters=g,k.out("ProxyManager","merge VAST AdParameters: "+i.creativeData.AdParameters)}catch(a){k.out("ProxyManager","fail to merge AdParameters: "+a)}switch(e.mimeType){case"application/javascript":case"application/x-javascript":case"text/javascript":k.out("ProxyManager","media file type: "+e.mimeType),core.vpaidManager.init(a,b,e,c);break;case"application/x-shockwave-flash":case"video/x-flv":k.error("ProxyManager","media file type not supported: "+e.mimeType),h("AdError"),h("AdStopped");break;default:k.out("ProxyManager","media file type: "+e.mimeType),core.videoManager.init(a,b,e,c)}}function f(a){var b,c,d,e,f={collector:"mtrcsCollectorDomain",pjid:"mtrcsProjectID",cpid:"mtrcsCampaign",site:"mtrcsSite",place:"mtrcsPlacement",adc:"mtrcsZone",cid:"mtrcsCreative",adv:"mtrcsAdvertiser",apa:"mtrcsParameterA",apb:"mtrcsParameterB",apc:"mtrcsParameterC",apd:"mtrcsParameterD",ape:"mtrcsParameterE",dur:"mtrcsAdDuration"};try{for(var h=0;h<a.length;h++)if(Object.keys(a[h].attributes).length>0){if(b=a[h].attributes.type,c=a[h].children&&a[h].children[0]&&a[h].children[0].value,!b||!c)continue;b.indexOf("MeetricsData")>-1?(e=b.split("-")[1]||a[h].attributes.name)&&g(f,e,c):(d=f[b],i.hasOwnProperty(d)&&"extension"==i[d].toLowerCase()&&(i[d]=c,k.out("ProxyManager","get VAST extension: "+b+" ("+d+"): "+c)))}}catch(a){k.error("ProxyManager","fail to parse VAST extensions: "+a)}}function g(a,b,c){var d,e,f;if(b&&"function"==typeof b.toLowerCase){b=b.toLowerCase();for(d in a)a.hasOwnProperty(d)&&(e=c.split(d+"=")[1])&&""!==e&&(e=e.split("&")[0],f=a[d],i.hasOwnProperty(f)&&i[f].toLowerCase()=="extension-"+b&&(i[f]=decodeURIComponent(e),k.out("ProxyManager","get VAST single extension: "+d+" ("+f+"): "+i[f])))}}function h(a,b,c,d){a in i.playerEventsCallback&&(k.out("ProxyManager","call player callback: "+a),"AdClickThru"==a?i.playerEventsCallback[a](b,c,d):i.playerEventsCallback[a]())}var i,j,k,core;return{init:a,fireVpaidEvent:h}}(),n=function(){function a(a,b,c,d){J=MeetricsVPAID.prototype.utils.log,Y=MeetricsVPAID.prototype.utils.helpers,I=MeetricsVPAID.prototype.model.config,L=MeetricsVPAID.prototype.core.proxyManager,Z=MeetricsVPAID.prototype.model.mediaFileParams,K=I.videoSlot,W=I.slot,T=new DMVAST.tracker(a,b),ga=b.duration,null!==K&&"VIDEO"===K.nodeName||(K=ia.createElement("video"),J.info("VideoManager","No video element passed to ad, a new element will be created."),K.style.backgroundColor="#000",W.appendChild(K)),V=b.videoClickThroughURLTemplate?b.videoClickThroughURLTemplate:"",I.playerWrapper=MeetricsVPAID.prototype.core.videoManager,U=new MeetricsTracker(I),U.initAd(I.width,I.height,Math.floor(1e9*Math.random()).toString(),I.videoSlot.id),K.addEventListener("loadedmetadata",o),K.width=I.width,K.height=I.height,I.width&&I.height||(K.width=W.clientWidth,K.height=W.clientHeight,K.style.position="absolute"),W&&W.offsetParent&&0===W.offsetParent.offsetHeight&&W.offsetHeight>0&&(W.style.position="relative"),0===K.width||0===K.height?I.width&&I.height?(Q=I.width,R=I.height):(Q=W.clientWidth,R=W.clientHeight):(Q=K.width,R=K.height),K.src=c.fileURL;try{K.load()}catch(a){}X=W.clientWidth+"x"+W.clientHeight,fa=!1,ea=setTimeout(function(){J.info("VideoManager","event listener loadedmetadata timeout"),o()},500),J.out("VideoManager","init")}function b(){I.meetricsCountdown&&($=MeetricsVPAID.prototype.view.countdownAd,$.build()),I.meetricsShowSkipAfter>=0&&(_=MeetricsVPAID.prototype.view.countdownSkip,_.build()),I.meetricsPlayButton&&(aa=MeetricsVPAID.prototype.view.playBtn,aa.build(K)),I.meetricsMuteButton&&(ca=MeetricsVPAID.prototype.view.muteBtn,ca.build(K)),I.meetricsFullscreenButton&&(da=MeetricsVPAID.prototype.view.fullscreenBtn,da.build(K))}function c(){if(J.out("VideoManager","start"),na){na=!1;var a=isNaN(K.duration)?ga:K.duration;U.syncProgress(a),M=Math.round(.25*a),N=Math.round(.5*a),O=Math.round(.75*a),K.addEventListener("error",u),K.addEventListener("ended",p),K.addEventListener("timeupdate",q),K.addEventListener("pause",r),K.addEventListener("play",s),K.addEventListener("playing",t),w("start");try{K.currentTime=0}catch(a){}K.play().then(function(){b()}).catch(function(error){U.callMtrcsTrigger(42,15,1),K.muted=!0,K.play().then(function(){I.meetricsMuteButton=!0,oa=!1}).catch(function(error){K.muted=!1,U.callMtrcsTrigger(42,15,2),U.pauseAd(),L.fireVpaidEvent("AdPaused"),T.setPaused(!0),I.meetricsPlayButton=!0,n()}).then(function(){b()})})}}function d(){J.out("VideoManager","pause"),K.pause()}function e(){J.out("VideoManager","resume"),K.play()}function f(){J.out("VideoManager","skip"),K.pause(),w("skip"),w("stop")}function g(){J.out("VideoManager","stop"),K.pause(),w("stop")}function h(){J.out("VideoManager","reset"),K.removeEventListener("error",u),K.removeEventListener("stalled",u),K.removeEventListener("abort",u),K.removeEventListener("ended",p),K.removeEventListener("timeupdate",q),K.removeEventListener("pause",r),K.removeEventListener("play",s),I.playerWrapper=null}function i(a,b,c){var d;ma||(ma=a>I.width),ma?a<I.width?(d="normal",ma=!1):d="fullscreen":d="normal",J.out("VideoManager","resize width: "+a+" height: "+b+" viewMode: "+d),w(d),I.viewMode=d,I.width=a,I.height=b,K.width=a,K.height=b}function j(a){J.out("VideoManager","enable clickThrough: "+a),a?(P=k(),P.addEventListener("click",v),setTimeout(m,500)):P&&(null!==P.parentNode&&I.slot.removeChild(P),P.removeEventListener("click",v),P=void 0)}function k(){var a=ia.createElement("div");return a.style.position="absolute",I.slot.appendChild(a),l(a),a}function l(a){a.style.height=R+"px",a.style.width=Q+"px",a.offsetTop&&a.offsetTop>10&&(a.style.marginTop="-"+a.offsetTop+"px")}function m(){P&&(X!==W.clientWidth+"x"+W.clientHeight&&(X=W.clientWidth+"x"+W.clientHeight,Q=W.clientWidth,R=W.clientHeight,l(P)),setTimeout(m,500))}function n(){ba=MeetricsVPAID.prototype.view.bigPlayBtn,ba.build(K),ba.toggleBtn(!0)}function o(){fa||(fa=!0,window.clearTimeout(ea),K.removeEventListener("loadedmetadata",o),L.fireVpaidEvent("AdLoaded"))}function p(){w("complete"),w("stop")}function q(){if("undefined"!=typeof Math){switch(S=Math.round(K.currentTime)){case M:M=NaN,w("25%");break;case N:N=NaN,w("50%");break;case O:O=NaN,w("75%")}w("progress"),S!==ha&&($&&$.update(),_&&_.update(),ha=S),U.reportOffset(K.currentTime),U.syncProgress(K.duration-K.currentTime)}}function r(){w("pause")}function s(){w("resume")}function t(){K.removeEventListener("playing",t),K&&K.webkitFullscreenElement&&U.callMtrcsTrigger(42,21,1)}function u(a){J.error("VideoManager","video playback fail: "+a.type),w("error")}function v(){V&&""!==V&&(window.open(V),w("click")),J.out("VideoManager","goto clickThrough URI: "+V)}function w(a){var b;switch(J.event("VideoManager","on video event: "+a),a){case"start":j(!0),U.startAd(),U.sendQuartile(0),L.fireVpaidEvent("AdStarted"),L.fireVpaidEvent("AdImpression"),L.fireVpaidEvent("AdVideoStart"),T.load(),T.track("start"),U.callMtrcsTrigger(42,17,1),J.track("VideoManager","VAST event: Impression"),J.track("VideoManager","VAST event: creativeView"),J.track("VideoManager","VAST event: start");var c=I.meetricsVolume;if(-1!==c&&x(c/100),la){la=!1;var d=0===K.volume?0:1;U.callMtrcsTrigger(46,d)}break;case"25%":U.sendQuartile(25),L.fireVpaidEvent("AdVideoFirstQuartile"),T.track("firstQuartile"),J.track("VideoManager","VAST event: firstQuartile");break;case"50%":U.sendQuartile(50),L.fireVpaidEvent("AdVideoMidpoint"),T.track("midpoint"),J.track("VideoManager","VAST event: midpoint");break;case"75%":U.sendQuartile(75),L.fireVpaidEvent("AdVideoThirdQuartile"),T.track("thirdQuartile"),J.track("VideoManager","VAST event: thirdQuartile");break;case"stop":j(!1),U.stopAd(),0===DMVAST.util.pendingEvents.length?L.fireVpaidEvent("AdStopped"):b=setInterval(function(){0===DMVAST.util.pendingEvents.length&&(L.fireVpaidEvent("AdStopped"),clearInterval(b))},50),h();break;case"complete":U.sendQuartile(100),L.fireVpaidEvent("AdVideoComplete"),T.complete(),J.track("VideoManager","VAST event: complete");break;case"error":L.fireVpaidEvent("AdError"),T.errorWithCode(400),J.track("VideoManager","VAST event: Error"),h();break;case"click":U.clickAd(),L.fireVpaidEvent("AdClickThru"),T.click(),J.track("VideoManager","VAST event: ClickTracking");break;case"mute":U.adVolume(K.volume),L.fireVpaidEvent("AdVolumeChange"),T.setMuted(!0),J.track("VideoManager","VAST event: mute");break;case"unmute":U.adVolume(K.volume),L.fireVpaidEvent("AdVolumeChange"),T.setMuted(!1),J.track("VideoManager","VAST event: unmute");break;case"fullscreen":U.resizeAd(K.width,K.height),L.fireVpaidEvent("AdSizeChange"),T.setFullscreen(!0),J.track("VideoManager","VAST event: fullscreen");break;case"normal":U.resizeAd(K.width,K.height),L.fireVpaidEvent("AdSizeChange"),T.setFullscreen(!1),J.track("VideoManager","VAST event: exitFullscreen");break;case"resume":U.resumeAd(),L.fireVpaidEvent("AdPlaying"),T.setPaused(!1),J.track("VideoManager","VAST event: resume");break;case"pause":if(K.duration-K.currentTime<=0)break;U.pauseAd(),L.fireVpaidEvent("AdPaused"),T.setPaused(!0),J.track("VideoManager","VAST event: pause");break;case"skip":L.fireVpaidEvent("AdSkipped"),T.skip(),J.track("VideoManager","VAST event: close");break;case"progress":L.fireVpaidEvent("AdRemainingTimeChange")}}function x(a){J.info("VideoManager","setAdVolume: "+a),K.volume=a;var b=a>0?"unmute":"mute";"unmute"===b&&!0===oa&&(K.muted=!1),w(b)}function y(){return J.out("VideoManager","getAdVolume: "+K.volume,"#00CC00"),K.volume}function z(){return K.width}function A(){return K.height}function B(){return ga-K.currentTime}function C(){return ga}function D(a){J.info("VideoManager","setAdSkippableState: "+a),ka=a}function E(){return ka}function F(a){J.info("VideoManager","setAdExpanded: "+a),ja=a,w(a?"fullscreen":"normal")}function G(){return ja}function H(){oa=!0}var I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga=0,ha=0,ia=document,ja=!1,ka=!1,la=!0,ma=!1,na=!0,oa=!0;return{init:a,startAd:c,pauseAd:d,resumeAd:e,skipAd:f,stopAd:g,resizeAd:i,setAdVolume:x,setAdSkippableState:D,setAdExpanded:F,getAdVolume:y,getAdWidth:z,getAdHeight:A,getAdRemainingTime:B,getAdDuration:C,getAdSkippableState:E,getAdExpanded:G,setOkToUnmute:H}}(),o=function(){function a(a,d,e,f){i=MeetricsVPAID.prototype.utils.assetLoader,h=MeetricsVPAID.prototype.utils.log,g=MeetricsVPAID.prototype.model.config,j=MeetricsVPAID.prototype.core.proxyManager,k=new DMVAST.tracker(a,d),n=g.slot,m=d.videoClickThroughURLTemplate?d.videoClickThroughURLTemplate:"",i.loadJS(e.fileURL,c,b,g.meetricsTimeout),h.out("VPAIDmanager","init")}function b(a){h.error("VPAIDmanager","Vpaid Load Fail: "+a.type),onVPAIDAdEvent("AdError")}function c(a){var b;a.getVPAIDAd&&"function"==typeof a.getVPAIDAd?(g.vpaidAd=a.getVPAIDAd(),l=new MeetricsTracker(g),l.initAd(g.width,g.height,Math.floor(1e9*Math.random()).toString(),g.videoSlot.id),d(),g.vpaidAd.handshakeVersion(g.handshakeVersion),b=g.creativeData,g.specialAdParameters&&(b={AdParameters:g.specialAdParameters}),g.vpaidAd.initAd(g.width,g.height,g.viewMode,g.desiredBitrate,b,g.environmentVars),h.out("VPAIDmanager","Vpaid Load Success")):(onVPAIDAdEvent("AdError"),h.error("VPAIDmanager","fail to find VPAID Interface [win.getVPAIDAd()]"))}function d(){g.vpaidAd.subscribe(f("AdLoaded"),"AdLoaded",this),g.vpaidAd.subscribe(f("AdStarted"),"AdStarted",this),g.vpaidAd.subscribe(f("AdStopped"),"AdStopped",this),g.vpaidAd.subscribe(f("AdSkipped"),"AdSkipped",this),g.vpaidAd.subscribe(f("AdSkippableStateChange"),"AdSkippableStateChange",this),g.vpaidAd.subscribe(f("AdSizeChange"),"AdSizeChange",this),g.vpaidAd.subscribe(f("AdLinearChange"),"AdLinearChange",this),g.vpaidAd.subscribe(f("AdDurationChange"),"AdDurationChange",this),g.vpaidAd.subscribe(f("AdExpandedChange"),"AdExpandedChange",this),g.vpaidAd.subscribe(f("AdRemainingTimeChange"),"AdRemainingTimeChange",this),g.vpaidAd.subscribe(f("AdVolumeChange"),"AdVolumeChange",this),g.vpaidAd.subscribe(f("AdImpression"),"AdImpression",this),g.vpaidAd.subscribe(f("AdVideoStart"),"AdVideoStart",this),g.vpaidAd.subscribe(f("AdVideoFirstQuartile"),"AdVideoFirstQuartile",this),g.vpaidAd.subscribe(f("AdVideoMidpoint"),"AdVideoMidpoint",this),g.vpaidAd.subscribe(f("AdVideoThirdQuartile"),"AdVideoThirdQuartile",this),g.vpaidAd.subscribe(f("AdVideoComplete"),"AdVideoComplete",this),g.vpaidAd.subscribe(f("AdClickThru"),"AdClickThru",this),g.vpaidAd.subscribe(f("AdInteraction"),"AdInteraction",this),g.vpaidAd.subscribe(f("AdUserAcceptInvitation"),"AdUserAcceptInvitation",this),g.vpaidAd.subscribe(f("AdUserMinimize"),"AdUserMinimize",this),g.vpaidAd.subscribe(f("AdUserClose"),"AdUserClose",this),g.vpaidAd.subscribe(f("AdPaused"),"AdPaused",this),g.vpaidAd.subscribe(f("AdPlaying"),"AdPlaying",this),g.vpaidAd.subscribe(f("AdLog"),"AdLog",this),g.vpaidAd.subscribe(f("AdError"),"AdError",this)}function e(){g.vpaidAd=null}function f(a){return function(b,c,d){switch(h.event("VPAIDmanager","on vpaid event: "+a+" with param1 "+b+", param2 "+c+", param3 "+d),a){case"AdSkipped":k.skip(),h.track("VPAIDmanager","VAST event: skip");break;case"AdStarted":o&&(o=!1,l.startAd());break;case"AdStopped":p&&(p=!1,l.stopAd(),e());break;case"AdLinearChange":break;case"AdExpandedChange":l.expandAd();break;case"AdRemainingTimeChange":g&&g.vpaidAd&&g.vpaidAd.getAdRemainingTime&&l.syncProgress(g.vpaidAd.getAdRemainingTime());break;case"AdVolumeChange":g.vpaidInterface.getAdVolume()<=0?(k.setMuted(!0),h.track("VPAIDmanager","VAST event: mute")):(k.setMuted(!1),h.track("VPAIDmanager","VAST event: unmute")),g&&g.vpaidAd&&g.vpaidAd.getAdVolume&&l.adVolume(g.vpaidAd.getAdVolume());break;case"AdImpression":k.load(),l.callMtrcsTrigger(42,17,1),h.track("VPAIDmanager","VAST event: Impression"),h.track("VPAIDmanager","VAST event: creativeView");break;case"AdVideoStart":l.sendQuartile(0),l.resumeAd(),k.track("start"),h.track("VPAIDmanager","VAST event: start");break;case"AdVideoFirstQuartile":l.sendQuartile(25),k.track("firstQuartile"),h.track("VPAIDmanager","VAST event: firstQuartile");break;case"AdVideoMidpoint":l.sendQuartile(50),k.track("midpoint"),h.track("VPAIDmanager","VAST event: midpoint");break;case"AdVideoThirdQuartile":l.sendQuartile(75),k.track("thirdQuartile"),h.track("VPAIDmanager","VAST event: thirdQuartile");break;case"AdVideoComplete":p&&(p=!1,e(),l.stopAd()),l.sendQuartile(100),k.complete(),h.track("VPAIDmanager","VAST event: complete");break;case"AdClickThru":if(l.clickAd(),k.click(),h.track("VPAIDmanager","VAST event: ClickTracking"),d||b&&""!==b)return!d||b&&""!==b||!m||""===m||(b=m),j.fireVpaidEvent(a,b,c,d),void h.out("VPAIDmanager","forwarding clickthrough instructions to player: url "+b+", id "+c+", playerHandles "+d);m&&""!==m&&(window.open(m),h.out("VPAIDmanager","goto clickThrough URI: "+m));break;case"AdUserAcceptInvitation":k.track("acceptInvitation"),h.track("VPAIDmanager","VAST event: acceptInvitation");break;case"AdUserMinimize":l.collapseAd(),k.track("collapse"),h.track("VPAIDmanager","VAST event: collapse");break;case"AdUserClose":k.stop(),k.track("close"),h.track("VPAIDmanager","VAST event: close");break;case"AdPaused":l.pauseAd(),k.setPaused(!0),h.track("VPAIDmanager","VAST event: pause");break;case"AdPlaying":l.resumeAd(),k.setPaused(!1),h.track("VPAIDmanager","VAST event: resume");break;case"AdError":k.errorWithCode(400),h.track("VPAIDmanager","VAST event: Error")}j.fireVpaidEvent(a)}}var g,h,i,j,k,l,m,n,o=!0,p=!0;return{init:a}}();return{init:m.init,model:{config:b,language:c,mediaFileParams:mediaFileParams},utils:{assetLoader:d,log:f,helpers:e},view:{countdownAd:h,countdownSkip:i,fullscreenBtn:j,muteBtn:k,playBtn:l,bigPlayBtn:g},core:{proxyManager:m,videoManager:n,vpaidManager:o}}}();var IVPAID=function(){this.log=MeetricsVPAID.prototype.utils.log,this.conf=MeetricsVPAID.prototype.model.config};IVPAID.prototype.handshakeVersion=function(a){return this.log.out("IVPAID","player call handshakeVersion version: "+a,"#663300"),this.conf.HANDSHAKE_VERSION},IVPAID.prototype.initAd=function(a,b,c,d,e,f){this.log.out("IVPAID","player call initAd","#663300"),MeetricsVPAID.prototype.init(a,b,c,d,e,f,this)},IVPAID.prototype.startAd=function(){this.log.out("IVPAID","player call startAd","#663300"),this.conf.vpaidAd?this.conf.vpaidAd.startAd():this.conf.playerWrapper&&this.conf.playerWrapper.startAd()},IVPAID.prototype.stopAd=function(){this.log.out("IVPAID","player call stopAd","#663300"),this.conf.vpaidAd?this.conf.vpaidAd.stopAd():this.conf.playerWrapper&&this.conf.playerWrapper.stopAd()},IVPAID.prototype.resizeAd=function(a,b,c){this.log.out("IVPAID","player call resizeAd width: "+a+" height: "+b+" viewMode: "+c,"#663300"),this.conf.vpaidAd&&this.conf.vpaidAd.resizeAd?this.conf.vpaidAd.resizeAd(a,b,c):this.conf.playerWrapper&&this.conf.playerWrapper.resizeAd(a,b,c)},IVPAID.prototype.pauseAd=function(){this.log.out("IVPAID","player call pauseAd","#663300"),this.conf.vpaidAd?this.conf.vpaidAd.pauseAd():this.conf.playerWrapper&&this.conf.playerWrapper.pauseAd()},IVPAID.prototype.resumeAd=function(){this.log.out("IVPAID","player call resumeAd","#663300"),this.conf.vpaidAd?this.conf.vpaidAd.resumeAd():this.conf.playerWrapper&&this.conf.playerWrapper.resumeAd()},IVPAID.prototype.expandAd=function(){this.log.out("IVPAID","player call expandAd","#663300"),this.conf.vpaidAd&&this.conf.vpaidAd.expandAd()},IVPAID.prototype.collapseAd=function(){this.log.out("IVPAID","player call collapseAd","#663300"),this.conf.vpaidAd&&this.conf.vpaidAd.collapseAd()},IVPAID.prototype.skipAd=function(){this.log.out("IVPAID","player call skipAd","#663300"),this.conf.vpaidAd?this.conf.vpaidAd.skipAd():this.conf.playerWrapper&&this.conf.playerWrapper.skipAd()},IVPAID.prototype.subscribe=function(a,b,c){this.log.out("IVPAID","player subscribe: "+b,"#663300"),this.conf.playerEventsCallback[b]=c?a.bind(c):a},IVPAID.prototype.unsubscribe=function(a){this.log.out("IVPAID","player unsubscribe: "+a,"#663300"),this.conf.playerEventsCallback[a]=null},IVPAID.prototype.setAdVolume=function(a){this.log.out("IVPAID","player set AdVolume: "+a,"#663300"),this.conf.vpaidAd?this.conf.vpaidAd.setAdVolume(a):this.conf.playerWrapper&&this.conf.playerWrapper.setAdVolume(a)},IVPAID.prototype.getAdVolume=function(){var a=this.conf.vpaidAd?this.conf.vpaidAd.getAdVolume():this.conf.playerWrapper?this.conf.playerWrapper.getAdVolume():0;return this.log.out("IVPAID","player get AdVolume: "+a,"#663300"),a},IVPAID.prototype.getAdExpanded=function(){var a=this.conf.vpaidAd?this.conf.vpaidAd.getAdExpanded():!!this.conf.playerWrapper&&this.conf.playerWrapper.getAdExpanded();return this.log.out("IVPAID","player get AdExpanded: "+a,"#663300"),a},IVPAID.prototype.getAdSkippableState=function(){var a=this.conf.vpaidAd?this.conf.vpaidAd.getAdSkippableState():!!this.conf.playerWrapper&&this.conf.playerWrapper.getAdSkippableState();return this.log.out("IVPAID","player get AdSkippableState: "+a,"#663300"),a},IVPAID.prototype.getAdWidth=function(){var a=this.conf.vpaidAd?this.conf.vpaidAd.getAdWidth():this.conf.playerWrapper?this.conf.playerWrapper.getAdWidth():0;return this.log.out("IVPAID","player get AdWidth: "+a,"#663300"),a},IVPAID.prototype.getAdHeight=function(){var a=this.conf.vpaidAd?this.conf.vpaidAd.getAdHeight():this.conf.playerWrapper?this.conf.playerWrapper.getAdHeight():0;return this.log.out("IVPAID","player get AdHeight: "+a,"#663300"),a},IVPAID.prototype.getAdDuration=function(){var a=this.conf.vpaidAd?this.conf.vpaidAd.getAdDuration():this.conf.playerWrapper?this.conf.playerWrapper.getAdDuration():0;return this.log.out("IVPAID","player get AdDuration: "+a,"#663300"),a},IVPAID.prototype.getAdCompanions=function(){var a=this.conf.vpaidAd&&"function"==typeof this.conf.vpaidAd.getAdCompanions?this.conf.vpaidAd.getAdCompanions():"";return this.log.out("IVPAID","player call getAdCompanions","#663300"),a},IVPAID.prototype.getAdIcons=function(){var a=this.conf.vpaidAd?this.conf.vpaidAd.getAdIcons():"";return this.log.out("IVPAID","player get AdIcons: "+a,"#663300"),a},IVPAID.prototype.getAdLinear=function(){var a=!this.conf.vpaidAd||this.conf.vpaidAd.getAdLinear();return this.log.out("IVPAID","player get AdLinear: "+a,"#663300"),a},IVPAID.prototype.getAdRemainingTime=function(){var a=this.conf.vpaidAd?this.conf.vpaidAd.getAdRemainingTime():this.conf.playerWrapper?this.conf.playerWrapper.getAdRemainingTime():0;return this.log.out("IVPAID","player get AdRemainingTime: "+a,"#663300"),a},window.getVPAIDAd=function(){return new IVPAID};
